"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/webhook/twilio/route";
exports.ids = ["app/api/webhook/twilio/route"];
exports.modules = {

/***/ "mongodb":
/*!**************************!*\
  !*** external "mongodb" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("mongodb");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "http2":
/*!************************!*\
  !*** external "http2" ***!
  \************************/
/***/ ((module) => {

module.exports = require("http2");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("net");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("querystring");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tls");

/***/ }),

/***/ "tty":
/*!**********************!*\
  !*** external "tty" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tty");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwebhook%2Ftwilio%2Froute&page=%2Fapi%2Fwebhook%2Ftwilio%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwebhook%2Ftwilio%2Froute.ts&appDir=C%3A%5CUsers%5Cdylan%5COneDrive%5CDesktop%5Cdylan-portfolio%5Cticketwatch%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cdylan%5COneDrive%5CDesktop%5Cdylan-portfolio%5Cticketwatch&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwebhook%2Ftwilio%2Froute&page=%2Fapi%2Fwebhook%2Ftwilio%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwebhook%2Ftwilio%2Froute.ts&appDir=C%3A%5CUsers%5Cdylan%5COneDrive%5CDesktop%5Cdylan-portfolio%5Cticketwatch%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cdylan%5COneDrive%5CDesktop%5Cdylan-portfolio%5Cticketwatch&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_dylan_OneDrive_Desktop_dylan_portfolio_ticketwatch_app_api_webhook_twilio_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/webhook/twilio/route.ts */ \"(rsc)/./app/api/webhook/twilio/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/webhook/twilio/route\",\n        pathname: \"/api/webhook/twilio\",\n        filename: \"route\",\n        bundlePath: \"app/api/webhook/twilio/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\dylan\\\\OneDrive\\\\Desktop\\\\dylan-portfolio\\\\ticketwatch\\\\app\\\\api\\\\webhook\\\\twilio\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_dylan_OneDrive_Desktop_dylan_portfolio_ticketwatch_app_api_webhook_twilio_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/webhook/twilio/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZ3ZWJob29rJTJGdHdpbGlvJTJGcm91dGUmcGFnZT0lMkZhcGklMkZ3ZWJob29rJTJGdHdpbGlvJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGd2ViaG9vayUyRnR3aWxpbyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNkeWxhbiU1Q09uZURyaXZlJTVDRGVza3RvcCU1Q2R5bGFuLXBvcnRmb2xpbyU1Q3RpY2tldHdhdGNoJTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1DJTNBJTVDVXNlcnMlNUNkeWxhbiU1Q09uZURyaXZlJTVDRGVza3RvcCU1Q2R5bGFuLXBvcnRmb2xpbyU1Q3RpY2tldHdhdGNoJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNzRDtBQUNuSTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3RpY2tldHdhdGNoLWxhbmRpbmcvPzNmMzUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcVXNlcnNcXFxcZHlsYW5cXFxcT25lRHJpdmVcXFxcRGVza3RvcFxcXFxkeWxhbi1wb3J0Zm9saW9cXFxcdGlja2V0d2F0Y2hcXFxcYXBwXFxcXGFwaVxcXFx3ZWJob29rXFxcXHR3aWxpb1xcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvd2ViaG9vay90d2lsaW8vcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS93ZWJob29rL3R3aWxpb1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvd2ViaG9vay90d2lsaW8vcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxVc2Vyc1xcXFxkeWxhblxcXFxPbmVEcml2ZVxcXFxEZXNrdG9wXFxcXGR5bGFuLXBvcnRmb2xpb1xcXFx0aWNrZXR3YXRjaFxcXFxhcHBcXFxcYXBpXFxcXHdlYmhvb2tcXFxcdHdpbGlvXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS93ZWJob29rL3R3aWxpby9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwebhook%2Ftwilio%2Froute&page=%2Fapi%2Fwebhook%2Ftwilio%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwebhook%2Ftwilio%2Froute.ts&appDir=C%3A%5CUsers%5Cdylan%5COneDrive%5CDesktop%5Cdylan-portfolio%5Cticketwatch%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cdylan%5COneDrive%5CDesktop%5Cdylan-portfolio%5Cticketwatch&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/webhook/twilio/route.ts":
/*!*****************************************!*\
  !*** ./app/api/webhook/twilio/route.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_handler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/handler */ \"(rsc)/./lib/handler.ts\");\n/* harmony import */ var _lib_twilio__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/twilio */ \"(rsc)/./lib/twilio.ts\");\n\n\n\nasync function POST(request) {\n    try {\n        // Twilio sends form-urlencoded data\n        const formData = await request.formData();\n        const from = formData.get(\"From\"); // e.g. \"whatsapp:+353858536569\"\n        const body = formData.get(\"Body\");\n        if (!from || !body) {\n            return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(\"Missing From or Body\", {\n                status: 400\n            });\n        }\n        // Extract phone number from Twilio format\n        const phone = from.replace(\"whatsapp:\", \"\");\n        const userId = from; // Use full Twilio ID as userId\n        console.log(`Incoming WhatsApp from ${phone}: ${body}`);\n        // Process the message\n        const response = await (0,_lib_handler__WEBPACK_IMPORTED_MODULE_1__.handleMessage)(userId, phone, body);\n        // Return TwiML response\n        return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse((0,_lib_twilio__WEBPACK_IMPORTED_MODULE_2__.generateTwimlResponse)(response), {\n            headers: {\n                \"Content-Type\": \"text/xml\"\n            }\n        });\n    } catch (error) {\n        console.error(\"Webhook error:\", error);\n        // Still return a valid TwiML response on error\n        return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse((0,_lib_twilio__WEBPACK_IMPORTED_MODULE_2__.generateTwimlResponse)(\"Sorry, something went wrong. Please try again.\"), {\n            headers: {\n                \"Content-Type\": \"text/xml\"\n            }\n        });\n    }\n}\n// Twilio may send GET for verification\nasync function GET() {\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        status: \"ok\",\n        service: \"TicketWatch WhatsApp Bot\"\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3dlYmhvb2svdHdpbGlvL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQXdEO0FBQ1Y7QUFDTztBQUU5QyxlQUFlRyxLQUFLQyxPQUFvQjtJQUM3QyxJQUFJO1FBQ0Ysb0NBQW9DO1FBQ3BDLE1BQU1DLFdBQVcsTUFBTUQsUUFBUUMsUUFBUTtRQUN2QyxNQUFNQyxPQUFPRCxTQUFTRSxHQUFHLENBQUMsU0FBbUIsZ0NBQWdDO1FBQzdFLE1BQU1DLE9BQU9ILFNBQVNFLEdBQUcsQ0FBQztRQUUxQixJQUFJLENBQUNELFFBQVEsQ0FBQ0UsTUFBTTtZQUNsQixPQUFPLElBQUlSLHFEQUFZQSxDQUFDLHdCQUF3QjtnQkFBRVMsUUFBUTtZQUFJO1FBQ2hFO1FBRUEsMENBQTBDO1FBQzFDLE1BQU1DLFFBQVFKLEtBQUtLLE9BQU8sQ0FBQyxhQUFhO1FBQ3hDLE1BQU1DLFNBQVNOLE1BQU0sK0JBQStCO1FBRXBETyxRQUFRQyxHQUFHLENBQUMsQ0FBQyx1QkFBdUIsRUFBRUosTUFBTSxFQUFFLEVBQUVGLEtBQUssQ0FBQztRQUV0RCxzQkFBc0I7UUFDdEIsTUFBTU8sV0FBVyxNQUFNZCwyREFBYUEsQ0FBQ1csUUFBUUYsT0FBT0Y7UUFFcEQsd0JBQXdCO1FBQ3hCLE9BQU8sSUFBSVIscURBQVlBLENBQUNFLGtFQUFxQkEsQ0FBQ2EsV0FBVztZQUN2REMsU0FBUztnQkFBRSxnQkFBZ0I7WUFBVztRQUN4QztJQUNGLEVBQUUsT0FBT0MsT0FBWTtRQUNuQkosUUFBUUksS0FBSyxDQUFDLGtCQUFrQkE7UUFFaEMsK0NBQStDO1FBQy9DLE9BQU8sSUFBSWpCLHFEQUFZQSxDQUNyQkUsa0VBQXFCQSxDQUFDLG1EQUN0QjtZQUFFYyxTQUFTO2dCQUFFLGdCQUFnQjtZQUFXO1FBQUU7SUFFOUM7QUFDRjtBQUVBLHVDQUF1QztBQUNoQyxlQUFlRTtJQUNwQixPQUFPbEIscURBQVlBLENBQUNtQixJQUFJLENBQUM7UUFBRVYsUUFBUTtRQUFNVyxTQUFTO0lBQTJCO0FBQy9FIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGlja2V0d2F0Y2gtbGFuZGluZy8uL2FwcC9hcGkvd2ViaG9vay90d2lsaW8vcm91dGUudHM/MGM5ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xyXG5pbXBvcnQgeyBoYW5kbGVNZXNzYWdlIH0gZnJvbSAnQC9saWIvaGFuZGxlcic7XHJcbmltcG9ydCB7IGdlbmVyYXRlVHdpbWxSZXNwb25zZSB9IGZyb20gJ0AvbGliL3R3aWxpbyc7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBUd2lsaW8gc2VuZHMgZm9ybS11cmxlbmNvZGVkIGRhdGFcclxuICAgIGNvbnN0IGZvcm1EYXRhID0gYXdhaXQgcmVxdWVzdC5mb3JtRGF0YSgpO1xyXG4gICAgY29uc3QgZnJvbSA9IGZvcm1EYXRhLmdldCgnRnJvbScpIGFzIHN0cmluZzsgLy8gZS5nLiBcIndoYXRzYXBwOiszNTM4NTg1MzY1NjlcIlxyXG4gICAgY29uc3QgYm9keSA9IGZvcm1EYXRhLmdldCgnQm9keScpIGFzIHN0cmluZztcclxuXHJcbiAgICBpZiAoIWZyb20gfHwgIWJvZHkpIHtcclxuICAgICAgcmV0dXJuIG5ldyBOZXh0UmVzcG9uc2UoJ01pc3NpbmcgRnJvbSBvciBCb2R5JywgeyBzdGF0dXM6IDQwMCB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBFeHRyYWN0IHBob25lIG51bWJlciBmcm9tIFR3aWxpbyBmb3JtYXRcclxuICAgIGNvbnN0IHBob25lID0gZnJvbS5yZXBsYWNlKCd3aGF0c2FwcDonLCAnJyk7XHJcbiAgICBjb25zdCB1c2VySWQgPSBmcm9tOyAvLyBVc2UgZnVsbCBUd2lsaW8gSUQgYXMgdXNlcklkXHJcblxyXG4gICAgY29uc29sZS5sb2coYEluY29taW5nIFdoYXRzQXBwIGZyb20gJHtwaG9uZX06ICR7Ym9keX1gKTtcclxuXHJcbiAgICAvLyBQcm9jZXNzIHRoZSBtZXNzYWdlXHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGhhbmRsZU1lc3NhZ2UodXNlcklkLCBwaG9uZSwgYm9keSk7XHJcblxyXG4gICAgLy8gUmV0dXJuIFR3aU1MIHJlc3BvbnNlXHJcbiAgICByZXR1cm4gbmV3IE5leHRSZXNwb25zZShnZW5lcmF0ZVR3aW1sUmVzcG9uc2UocmVzcG9uc2UpLCB7XHJcbiAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICd0ZXh0L3htbCcgfSxcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ1dlYmhvb2sgZXJyb3I6JywgZXJyb3IpO1xyXG5cclxuICAgIC8vIFN0aWxsIHJldHVybiBhIHZhbGlkIFR3aU1MIHJlc3BvbnNlIG9uIGVycm9yXHJcbiAgICByZXR1cm4gbmV3IE5leHRSZXNwb25zZShcclxuICAgICAgZ2VuZXJhdGVUd2ltbFJlc3BvbnNlKCdTb3JyeSwgc29tZXRoaW5nIHdlbnQgd3JvbmcuIFBsZWFzZSB0cnkgYWdhaW4uJyksXHJcbiAgICAgIHsgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ3RleHQveG1sJyB9IH1cclxuICAgICk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBUd2lsaW8gbWF5IHNlbmQgR0VUIGZvciB2ZXJpZmljYXRpb25cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVCgpIHtcclxuICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdGF0dXM6ICdvaycsIHNlcnZpY2U6ICdUaWNrZXRXYXRjaCBXaGF0c0FwcCBCb3QnIH0pO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJoYW5kbGVNZXNzYWdlIiwiZ2VuZXJhdGVUd2ltbFJlc3BvbnNlIiwiUE9TVCIsInJlcXVlc3QiLCJmb3JtRGF0YSIsImZyb20iLCJnZXQiLCJib2R5Iiwic3RhdHVzIiwicGhvbmUiLCJyZXBsYWNlIiwidXNlcklkIiwiY29uc29sZSIsImxvZyIsInJlc3BvbnNlIiwiaGVhZGVycyIsImVycm9yIiwiR0VUIiwianNvbiIsInNlcnZpY2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/webhook/twilio/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/handler.ts":
/*!************************!*\
  !*** ./lib/handler.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   handleMessage: () => (/* binding */ handleMessage)\n/* harmony export */ });\n/* harmony import */ var _parser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./parser */ \"(rsc)/./lib/parser.ts\");\n/* harmony import */ var _mongodb__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mongodb */ \"(rsc)/./lib/mongodb.ts\");\n/* harmony import */ var _ticketmaster__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ticketmaster */ \"(rsc)/./lib/ticketmaster.ts\");\n\n\n\nconst FREE_TIER_MAX_WATCHES = 1;\nasync function handleMessage(userId, phone, messageText) {\n    // Ensure user exists\n    await (0,_mongodb__WEBPACK_IMPORTED_MODULE_1__.createUser)(userId, phone);\n    // Check for pending conversation state (e.g. watch confirmation)\n    const state = await (0,_mongodb__WEBPACK_IMPORTED_MODULE_1__.getConversationState)(userId);\n    if (state?.action === \"confirm_watch\") {\n        const intent = (0,_parser__WEBPACK_IMPORTED_MODULE_0__.parseIntent)(messageText);\n        if (intent.intent === \"confirm\") {\n            return handleWatchConfirm(userId, state.data);\n        } else if (intent.intent === \"deny\") {\n            await (0,_mongodb__WEBPACK_IMPORTED_MODULE_1__.setConversationState)(userId, null);\n            return \"No worries, watch cancelled. Send another message anytime!\";\n        }\n        // If they said something else, clear state and process normally\n        await (0,_mongodb__WEBPACK_IMPORTED_MODULE_1__.setConversationState)(userId, null);\n    }\n    // Parse intent\n    const intentResult = (0,_parser__WEBPACK_IMPORTED_MODULE_0__.parseIntent)(messageText);\n    switch(intentResult.intent){\n        case \"search\":\n            return handleSearch(intentResult);\n        case \"watch\":\n            return handleWatch(userId, intentResult);\n        case \"list\":\n            return handleList(userId);\n        case \"cancel\":\n            return handleCancel(userId, intentResult);\n        case \"status\":\n            return handleStatus(userId);\n        case \"help\":\n            return handleHelp();\n        default:\n            return \"Sorry, I didn't understand that. Send 'help' to see what I can do.\";\n    }\n}\nasync function handleSearch(intentResult) {\n    const query = intentResult.query;\n    if (!query) return \"What events are you looking for?\";\n    const events = await (0,_ticketmaster__WEBPACK_IMPORTED_MODULE_2__.searchEvents)(query, 5);\n    if (!events.length) {\n        return `No events found for '${query}'. Try a different artist or venue name.`;\n    }\n    const formatted = events.slice(0, 5).map(_ticketmaster__WEBPACK_IMPORTED_MODULE_2__.formatEvent).filter(Boolean);\n    const lines = [\n        `Found ${formatted.length} events:\\n`\n    ];\n    formatted.forEach((event, i)=>{\n        if (!event) return;\n        const statusIcon = event.status === \"onsale\" ? \"[ON SALE]\" : \"[OFF SALE]\";\n        const price = event.priceMin ? `€${event.priceMin}-€${event.priceMax}` : \"TBA\";\n        lines.push(`${i + 1}. *${event.name}*\\n` + `   ${event.venue}, ${event.city}\\n` + `   ${event.date} ${event.time}\\n` + `   ${price}\\n` + `   ${statusIcon}`);\n    });\n    lines.push(\"\\nWant to watch for any of these? Say 'watch for [event] under €[price]'\");\n    return lines.join(\"\\n\");\n}\nasync function handleWatch(userId, intentResult) {\n    if (intentResult.needsClarification) {\n        return intentResult.clarificationMessage || \"What event do you want to watch for?\";\n    }\n    const eventName = intentResult.eventName;\n    const maxPrice = intentResult.maxPrice;\n    const quantity = intentResult.quantity || 1;\n    // Check tier limits\n    const tier = await (0,_mongodb__WEBPACK_IMPORTED_MODULE_1__.getUserTier)(userId);\n    const activeCount = await (0,_mongodb__WEBPACK_IMPORTED_MODULE_1__.countActiveWatches)(userId);\n    if (tier === \"free\" && activeCount >= FREE_TIER_MAX_WATCHES) {\n        return `You're on the free tier (max 1 watch). You already have ${activeCount} active watch. Cancel one or upgrade to Premium (€4.99/mo) for unlimited watches.`;\n    }\n    // Search for the event\n    const events = await (0,_ticketmaster__WEBPACK_IMPORTED_MODULE_2__.searchEvents)(eventName, 3);\n    if (!events.length) {\n        return `Couldn't find '${eventName}'. Check spelling or try searching first.`;\n    }\n    const event = events[0];\n    const fmt = (0,_ticketmaster__WEBPACK_IMPORTED_MODULE_2__.formatEvent)(event);\n    if (!fmt) return \"Error processing event data. Try again.\";\n    const price = fmt.priceMin ? ` (currently €${fmt.priceMin}-€${fmt.priceMax})` : \"\";\n    const maxPriceInfo = maxPrice ? ` under €${maxPrice}` : \"\";\n    // Store confirmation state\n    await (0,_mongodb__WEBPACK_IMPORTED_MODULE_1__.setConversationState)(userId, {\n        action: \"confirm_watch\",\n        data: {\n            eventId: event.id,\n            eventName: fmt.name,\n            venue: fmt.venue,\n            date: fmt.date,\n            maxPrice,\n            quantity,\n            buyUrl: fmt.url\n        }\n    });\n    return `Confirm your watch:\\n\\n` + `*${fmt.name}*${price}\\n` + `${fmt.venue} (${fmt.city})\\n` + `${fmt.date}\\n` + `Alert me for ${quantity}x tickets${maxPriceInfo}\\n` + `Current status: ${fmt.status}\\n\\n` + `Reply with 'yes' to confirm or 'no' to skip.`;\n}\nasync function handleWatchConfirm(userId, data) {\n    await (0,_mongodb__WEBPACK_IMPORTED_MODULE_1__.setConversationState)(userId, null);\n    const watchId = await (0,_mongodb__WEBPACK_IMPORTED_MODULE_1__.createWatch)(userId, data.eventId, data.eventName, data.venue, data.date, data.maxPrice, data.quantity, data.buyUrl);\n    if (!watchId) {\n        return `You're already watching ${data.eventName}. Cancel it first if you want to change the price.`;\n    }\n    const priceInfo = data.maxPrice ? ` under €${data.maxPrice}` : \"\";\n    return `Watch created for ${data.eventName}!\\n` + `I'll alert you on WhatsApp when ${data.quantity}x ticket(s) are available${priceInfo}.\\n\\n` + `Reply with 'my watches' to see your active watches.`;\n}\nasync function handleList(userId) {\n    const watches = await (0,_mongodb__WEBPACK_IMPORTED_MODULE_1__.getUserWatches)(userId, \"active\");\n    if (!watches.length) {\n        return \"You don't have any active watches.\\nStart with: 'Watch for [event] under €[price]'\";\n    }\n    const lines = [\n        \"Your active watches:\\n\"\n    ];\n    watches.forEach((w)=>{\n        const priceInfo = w.maxPrice ? ` (max €${w.maxPrice})` : \"\";\n        const created = new Date(w.createdAt).toLocaleDateString(\"en-IE\", {\n            day: \"numeric\",\n            month: \"short\"\n        });\n        lines.push(`- ${w.eventName}${priceInfo}\\n  ${w.quantity}x tickets, created ${created}`);\n    });\n    lines.push(\"\\nReply 'cancel [event]' to remove a watch.\");\n    return lines.join(\"\\n\");\n}\nasync function handleCancel(userId, intentResult) {\n    if (intentResult.needsClarification) {\n        return \"Which watch do you want to cancel?\\nReply with: 'cancel [event name]'\";\n    }\n    const eventName = intentResult.eventName;\n    const watches = await (0,_mongodb__WEBPACK_IMPORTED_MODULE_1__.getUserWatches)(userId, \"active\");\n    const match = watches.find((w)=>w.eventName.toLowerCase().includes(eventName.toLowerCase()));\n    if (!match) {\n        return `Didn't find a watch for '${eventName}'.\\nReply 'my watches' to see your active ones.`;\n    }\n    await (0,_mongodb__WEBPACK_IMPORTED_MODULE_1__.cancelWatch)(match._id.toString());\n    return `Cancelled watch for ${match.eventName}.`;\n}\nasync function handleStatus(userId) {\n    const watches = await (0,_mongodb__WEBPACK_IMPORTED_MODULE_1__.getUserWatches)(userId, \"active\");\n    if (!watches.length) {\n        return \"You don't have any active watches yet.\";\n    }\n    const lines = [\n        \"Checking your watches...\\n\"\n    ];\n    for (const watch of watches){\n        const result = await (0,_ticketmaster__WEBPACK_IMPORTED_MODULE_2__.checkAvailability)(watch.eventId, watch.maxPrice, watch.quantity);\n        if (result.available) {\n            lines.push(`*${watch.eventName}* - TICKETS AVAILABLE!\\n` + `   Price: €${result.price}\\n` + `   ${result.details}`);\n        } else {\n            lines.push(`${watch.eventName}: ${result.details}`);\n        }\n    }\n    return lines.join(\"\\n\");\n}\nfunction handleHelp() {\n    return \"*TicketWatch Help*\\n\\n\" + \"I help you find and watch for sold-out concert tickets in Ireland!\\n\\n\" + \"*Commands:*\\n\" + '- \"Watch for [artist] under €[price]\" - Create a ticket watch\\n' + '- \"My watches\" - See your active watches\\n' + '- \"Cancel [artist]\" - Remove a watch\\n' + '- \"[Artist name]\" - Search for events\\n' + '- \"Any updates?\" - Check your watches for new tickets\\n\\n' + \"*Pricing:*\\n\" + \"Free: 1 active watch\\n\" + \"Premium (€4.99/mo): Unlimited watches\\n\\n\" + \"Say 'watch for Bicep under €75' to start!\";\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUMsb0JBQW9CLEVBQUVMLE1BQU1yQixTQUFTLENBQUMsQ0FBQyxDQUFDO0FBQ2xEO0FBRUEsZUFBZTVCLGFBQWFiLE1BQWM7SUFDeEMsTUFBTXNELFVBQVUsTUFBTS9ELHdEQUFjQSxDQUFDUyxRQUFRO0lBRTdDLElBQUksQ0FBQ3NELFFBQVFyQyxNQUFNLEVBQUU7UUFDbkIsT0FBTztJQUNUO0lBRUEsTUFBTU0sUUFBUTtRQUFDO0tBQTZCO0lBRTVDLEtBQUssTUFBTTZDLFNBQVNkLFFBQVM7UUFDM0IsTUFBTWUsU0FBUyxNQUFNeEUsZ0VBQWlCQSxDQUFDdUUsTUFBTXBCLE9BQU8sRUFBRW9CLE1BQU0xQixRQUFRLEVBQUUwQixNQUFNekIsUUFBUTtRQUNwRixJQUFJMEIsT0FBT0MsU0FBUyxFQUFFO1lBQ3BCL0MsTUFBTVMsSUFBSSxDQUNSLENBQUMsQ0FBQyxFQUFFb0MsTUFBTTNCLFNBQVMsQ0FBQyx3QkFBd0IsQ0FBQyxHQUMzQyxDQUFDLFdBQVcsRUFBRTRCLE9BQU94QyxLQUFLLENBQUMsRUFBRSxDQUFDLEdBQzlCLENBQUMsR0FBRyxFQUFFd0MsT0FBT0UsT0FBTyxDQUFDLENBQUM7UUFFNUIsT0FBTztZQUNMaEQsTUFBTVMsSUFBSSxDQUFDLENBQUMsRUFBRW9DLE1BQU0zQixTQUFTLENBQUMsRUFBRSxFQUFFNEIsT0FBT0UsT0FBTyxDQUFDLENBQUM7UUFDcEQ7SUFDRjtJQUVBLE9BQU9oRCxNQUFNZSxJQUFJLENBQUM7QUFDcEI7QUFFQSxTQUFTeEI7SUFDUCxPQUNFLDJCQUNBLDJFQUNBLGtCQUNBLG9FQUNBLCtDQUNBLDJDQUNBLDRDQUNBLDhEQUNBLGlCQUNBLDJCQUNBLDhDQUNBO0FBRUoiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aWNrZXR3YXRjaC1sYW5kaW5nLy4vbGliL2hhbmRsZXIudHM/ZDk2NSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBwYXJzZUludGVudCB9IGZyb20gJy4vcGFyc2VyJztcclxuaW1wb3J0IHtcclxuICBjcmVhdGVVc2VyLFxyXG4gIGdldFVzZXJUaWVyLFxyXG4gIGNvdW50QWN0aXZlV2F0Y2hlcyxcclxuICBjcmVhdGVXYXRjaCxcclxuICBnZXRVc2VyV2F0Y2hlcyxcclxuICBjYW5jZWxXYXRjaCxcclxuICBnZXRDb252ZXJzYXRpb25TdGF0ZSxcclxuICBzZXRDb252ZXJzYXRpb25TdGF0ZSxcclxufSBmcm9tICcuL21vbmdvZGInO1xyXG5pbXBvcnQgeyBzZWFyY2hFdmVudHMsIGZvcm1hdEV2ZW50LCBjaGVja0F2YWlsYWJpbGl0eSB9IGZyb20gJy4vdGlja2V0bWFzdGVyJztcclxuXHJcbmNvbnN0IEZSRUVfVElFUl9NQVhfV0FUQ0hFUyA9IDE7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlTWVzc2FnZSh1c2VySWQ6IHN0cmluZywgcGhvbmU6IHN0cmluZywgbWVzc2FnZVRleHQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgLy8gRW5zdXJlIHVzZXIgZXhpc3RzXHJcbiAgYXdhaXQgY3JlYXRlVXNlcih1c2VySWQsIHBob25lKTtcclxuXHJcbiAgLy8gQ2hlY2sgZm9yIHBlbmRpbmcgY29udmVyc2F0aW9uIHN0YXRlIChlLmcuIHdhdGNoIGNvbmZpcm1hdGlvbilcclxuICBjb25zdCBzdGF0ZSA9IGF3YWl0IGdldENvbnZlcnNhdGlvblN0YXRlKHVzZXJJZCk7XHJcbiAgaWYgKHN0YXRlPy5hY3Rpb24gPT09ICdjb25maXJtX3dhdGNoJykge1xyXG4gICAgY29uc3QgaW50ZW50ID0gcGFyc2VJbnRlbnQobWVzc2FnZVRleHQpO1xyXG4gICAgaWYgKGludGVudC5pbnRlbnQgPT09ICdjb25maXJtJykge1xyXG4gICAgICByZXR1cm4gaGFuZGxlV2F0Y2hDb25maXJtKHVzZXJJZCwgc3RhdGUuZGF0YSk7XHJcbiAgICB9IGVsc2UgaWYgKGludGVudC5pbnRlbnQgPT09ICdkZW55Jykge1xyXG4gICAgICBhd2FpdCBzZXRDb252ZXJzYXRpb25TdGF0ZSh1c2VySWQsIG51bGwpO1xyXG4gICAgICByZXR1cm4gJ05vIHdvcnJpZXMsIHdhdGNoIGNhbmNlbGxlZC4gU2VuZCBhbm90aGVyIG1lc3NhZ2UgYW55dGltZSEnO1xyXG4gICAgfVxyXG4gICAgLy8gSWYgdGhleSBzYWlkIHNvbWV0aGluZyBlbHNlLCBjbGVhciBzdGF0ZSBhbmQgcHJvY2VzcyBub3JtYWxseVxyXG4gICAgYXdhaXQgc2V0Q29udmVyc2F0aW9uU3RhdGUodXNlcklkLCBudWxsKTtcclxuICB9XHJcblxyXG4gIC8vIFBhcnNlIGludGVudFxyXG4gIGNvbnN0IGludGVudFJlc3VsdCA9IHBhcnNlSW50ZW50KG1lc3NhZ2VUZXh0KTtcclxuXHJcbiAgc3dpdGNoIChpbnRlbnRSZXN1bHQuaW50ZW50KSB7XHJcbiAgICBjYXNlICdzZWFyY2gnOlxyXG4gICAgICByZXR1cm4gaGFuZGxlU2VhcmNoKGludGVudFJlc3VsdCk7XHJcbiAgICBjYXNlICd3YXRjaCc6XHJcbiAgICAgIHJldHVybiBoYW5kbGVXYXRjaCh1c2VySWQsIGludGVudFJlc3VsdCk7XHJcbiAgICBjYXNlICdsaXN0JzpcclxuICAgICAgcmV0dXJuIGhhbmRsZUxpc3QodXNlcklkKTtcclxuICAgIGNhc2UgJ2NhbmNlbCc6XHJcbiAgICAgIHJldHVybiBoYW5kbGVDYW5jZWwodXNlcklkLCBpbnRlbnRSZXN1bHQpO1xyXG4gICAgY2FzZSAnc3RhdHVzJzpcclxuICAgICAgcmV0dXJuIGhhbmRsZVN0YXR1cyh1c2VySWQpO1xyXG4gICAgY2FzZSAnaGVscCc6XHJcbiAgICAgIHJldHVybiBoYW5kbGVIZWxwKCk7XHJcbiAgICBkZWZhdWx0OlxyXG4gICAgICByZXR1cm4gXCJTb3JyeSwgSSBkaWRuJ3QgdW5kZXJzdGFuZCB0aGF0LiBTZW5kICdoZWxwJyB0byBzZWUgd2hhdCBJIGNhbiBkby5cIjtcclxuICB9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZVNlYXJjaChpbnRlbnRSZXN1bHQ6IGFueSk6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgY29uc3QgcXVlcnkgPSBpbnRlbnRSZXN1bHQucXVlcnk7XHJcbiAgaWYgKCFxdWVyeSkgcmV0dXJuICdXaGF0IGV2ZW50cyBhcmUgeW91IGxvb2tpbmcgZm9yPyc7XHJcblxyXG4gIGNvbnN0IGV2ZW50cyA9IGF3YWl0IHNlYXJjaEV2ZW50cyhxdWVyeSwgNSk7XHJcbiAgaWYgKCFldmVudHMubGVuZ3RoKSB7XHJcbiAgICByZXR1cm4gYE5vIGV2ZW50cyBmb3VuZCBmb3IgJyR7cXVlcnl9Jy4gVHJ5IGEgZGlmZmVyZW50IGFydGlzdCBvciB2ZW51ZSBuYW1lLmA7XHJcbiAgfVxyXG5cclxuICBjb25zdCBmb3JtYXR0ZWQgPSBldmVudHMuc2xpY2UoMCwgNSkubWFwKGZvcm1hdEV2ZW50KS5maWx0ZXIoQm9vbGVhbik7XHJcbiAgY29uc3QgbGluZXMgPSBbYEZvdW5kICR7Zm9ybWF0dGVkLmxlbmd0aH0gZXZlbnRzOlxcbmBdO1xyXG5cclxuICBmb3JtYXR0ZWQuZm9yRWFjaCgoZXZlbnQsIGkpID0+IHtcclxuICAgIGlmICghZXZlbnQpIHJldHVybjtcclxuICAgIGNvbnN0IHN0YXR1c0ljb24gPSBldmVudC5zdGF0dXMgPT09ICdvbnNhbGUnID8gJ1tPTiBTQUxFXScgOiAnW09GRiBTQUxFXSc7XHJcbiAgICBjb25zdCBwcmljZSA9IGV2ZW50LnByaWNlTWluID8gYOKCrCR7ZXZlbnQucHJpY2VNaW59LeKCrCR7ZXZlbnQucHJpY2VNYXh9YCA6ICdUQkEnO1xyXG4gICAgbGluZXMucHVzaChcclxuICAgICAgYCR7aSArIDF9LiAqJHtldmVudC5uYW1lfSpcXG5gICtcclxuICAgICAgICBgICAgJHtldmVudC52ZW51ZX0sICR7ZXZlbnQuY2l0eX1cXG5gICtcclxuICAgICAgICBgICAgJHtldmVudC5kYXRlfSAke2V2ZW50LnRpbWV9XFxuYCArXHJcbiAgICAgICAgYCAgICR7cHJpY2V9XFxuYCArXHJcbiAgICAgICAgYCAgICR7c3RhdHVzSWNvbn1gXHJcbiAgICApO1xyXG4gIH0pO1xyXG5cclxuICBsaW5lcy5wdXNoKFwiXFxuV2FudCB0byB3YXRjaCBmb3IgYW55IG9mIHRoZXNlPyBTYXkgJ3dhdGNoIGZvciBbZXZlbnRdIHVuZGVyIOKCrFtwcmljZV0nXCIpO1xyXG4gIHJldHVybiBsaW5lcy5qb2luKCdcXG4nKTtcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlV2F0Y2godXNlcklkOiBzdHJpbmcsIGludGVudFJlc3VsdDogYW55KTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICBpZiAoaW50ZW50UmVzdWx0Lm5lZWRzQ2xhcmlmaWNhdGlvbikge1xyXG4gICAgcmV0dXJuIGludGVudFJlc3VsdC5jbGFyaWZpY2F0aW9uTWVzc2FnZSB8fCAnV2hhdCBldmVudCBkbyB5b3Ugd2FudCB0byB3YXRjaCBmb3I/JztcclxuICB9XHJcblxyXG4gIGNvbnN0IGV2ZW50TmFtZSA9IGludGVudFJlc3VsdC5ldmVudE5hbWU7XHJcbiAgY29uc3QgbWF4UHJpY2UgPSBpbnRlbnRSZXN1bHQubWF4UHJpY2U7XHJcbiAgY29uc3QgcXVhbnRpdHkgPSBpbnRlbnRSZXN1bHQucXVhbnRpdHkgfHwgMTtcclxuXHJcbiAgLy8gQ2hlY2sgdGllciBsaW1pdHNcclxuICBjb25zdCB0aWVyID0gYXdhaXQgZ2V0VXNlclRpZXIodXNlcklkKTtcclxuICBjb25zdCBhY3RpdmVDb3VudCA9IGF3YWl0IGNvdW50QWN0aXZlV2F0Y2hlcyh1c2VySWQpO1xyXG5cclxuICBpZiAodGllciA9PT0gJ2ZyZWUnICYmIGFjdGl2ZUNvdW50ID49IEZSRUVfVElFUl9NQVhfV0FUQ0hFUykge1xyXG4gICAgcmV0dXJuIGBZb3UncmUgb24gdGhlIGZyZWUgdGllciAobWF4IDEgd2F0Y2gpLiBZb3UgYWxyZWFkeSBoYXZlICR7YWN0aXZlQ291bnR9IGFjdGl2ZSB3YXRjaC4gQ2FuY2VsIG9uZSBvciB1cGdyYWRlIHRvIFByZW1pdW0gKOKCrDQuOTkvbW8pIGZvciB1bmxpbWl0ZWQgd2F0Y2hlcy5gO1xyXG4gIH1cclxuXHJcbiAgLy8gU2VhcmNoIGZvciB0aGUgZXZlbnRcclxuICBjb25zdCBldmVudHMgPSBhd2FpdCBzZWFyY2hFdmVudHMoZXZlbnROYW1lLCAzKTtcclxuICBpZiAoIWV2ZW50cy5sZW5ndGgpIHtcclxuICAgIHJldHVybiBgQ291bGRuJ3QgZmluZCAnJHtldmVudE5hbWV9Jy4gQ2hlY2sgc3BlbGxpbmcgb3IgdHJ5IHNlYXJjaGluZyBmaXJzdC5gO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgZXZlbnQgPSBldmVudHNbMF07XHJcbiAgY29uc3QgZm10ID0gZm9ybWF0RXZlbnQoZXZlbnQpO1xyXG4gIGlmICghZm10KSByZXR1cm4gJ0Vycm9yIHByb2Nlc3NpbmcgZXZlbnQgZGF0YS4gVHJ5IGFnYWluLic7XHJcblxyXG4gIGNvbnN0IHByaWNlID0gZm10LnByaWNlTWluID8gYCAoY3VycmVudGx5IOKCrCR7Zm10LnByaWNlTWlufS3igqwke2ZtdC5wcmljZU1heH0pYCA6ICcnO1xyXG4gIGNvbnN0IG1heFByaWNlSW5mbyA9IG1heFByaWNlID8gYCB1bmRlciDigqwke21heFByaWNlfWAgOiAnJztcclxuXHJcbiAgLy8gU3RvcmUgY29uZmlybWF0aW9uIHN0YXRlXHJcbiAgYXdhaXQgc2V0Q29udmVyc2F0aW9uU3RhdGUodXNlcklkLCB7XHJcbiAgICBhY3Rpb246ICdjb25maXJtX3dhdGNoJyxcclxuICAgIGRhdGE6IHtcclxuICAgICAgZXZlbnRJZDogZXZlbnQuaWQsXHJcbiAgICAgIGV2ZW50TmFtZTogZm10Lm5hbWUsXHJcbiAgICAgIHZlbnVlOiBmbXQudmVudWUsXHJcbiAgICAgIGRhdGU6IGZtdC5kYXRlLFxyXG4gICAgICBtYXhQcmljZSxcclxuICAgICAgcXVhbnRpdHksXHJcbiAgICAgIGJ1eVVybDogZm10LnVybCxcclxuICAgIH0sXHJcbiAgfSk7XHJcblxyXG4gIHJldHVybiAoXHJcbiAgICBgQ29uZmlybSB5b3VyIHdhdGNoOlxcblxcbmAgK1xyXG4gICAgYCoke2ZtdC5uYW1lfSoke3ByaWNlfVxcbmAgK1xyXG4gICAgYCR7Zm10LnZlbnVlfSAoJHtmbXQuY2l0eX0pXFxuYCArXHJcbiAgICBgJHtmbXQuZGF0ZX1cXG5gICtcclxuICAgIGBBbGVydCBtZSBmb3IgJHtxdWFudGl0eX14IHRpY2tldHMke21heFByaWNlSW5mb31cXG5gICtcclxuICAgIGBDdXJyZW50IHN0YXR1czogJHtmbXQuc3RhdHVzfVxcblxcbmAgK1xyXG4gICAgYFJlcGx5IHdpdGggJ3llcycgdG8gY29uZmlybSBvciAnbm8nIHRvIHNraXAuYFxyXG4gICk7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZVdhdGNoQ29uZmlybSh1c2VySWQ6IHN0cmluZywgZGF0YTogYW55KTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICBhd2FpdCBzZXRDb252ZXJzYXRpb25TdGF0ZSh1c2VySWQsIG51bGwpO1xyXG5cclxuICBjb25zdCB3YXRjaElkID0gYXdhaXQgY3JlYXRlV2F0Y2goXHJcbiAgICB1c2VySWQsXHJcbiAgICBkYXRhLmV2ZW50SWQsXHJcbiAgICBkYXRhLmV2ZW50TmFtZSxcclxuICAgIGRhdGEudmVudWUsXHJcbiAgICBkYXRhLmRhdGUsXHJcbiAgICBkYXRhLm1heFByaWNlLFxyXG4gICAgZGF0YS5xdWFudGl0eSxcclxuICAgIGRhdGEuYnV5VXJsXHJcbiAgKTtcclxuXHJcbiAgaWYgKCF3YXRjaElkKSB7XHJcbiAgICByZXR1cm4gYFlvdSdyZSBhbHJlYWR5IHdhdGNoaW5nICR7ZGF0YS5ldmVudE5hbWV9LiBDYW5jZWwgaXQgZmlyc3QgaWYgeW91IHdhbnQgdG8gY2hhbmdlIHRoZSBwcmljZS5gO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgcHJpY2VJbmZvID0gZGF0YS5tYXhQcmljZSA/IGAgdW5kZXIg4oKsJHtkYXRhLm1heFByaWNlfWAgOiAnJztcclxuICByZXR1cm4gKFxyXG4gICAgYFdhdGNoIGNyZWF0ZWQgZm9yICR7ZGF0YS5ldmVudE5hbWV9IVxcbmAgK1xyXG4gICAgYEknbGwgYWxlcnQgeW91IG9uIFdoYXRzQXBwIHdoZW4gJHtkYXRhLnF1YW50aXR5fXggdGlja2V0KHMpIGFyZSBhdmFpbGFibGUke3ByaWNlSW5mb30uXFxuXFxuYCArXHJcbiAgICBgUmVwbHkgd2l0aCAnbXkgd2F0Y2hlcycgdG8gc2VlIHlvdXIgYWN0aXZlIHdhdGNoZXMuYFxyXG4gICk7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUxpc3QodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gIGNvbnN0IHdhdGNoZXMgPSBhd2FpdCBnZXRVc2VyV2F0Y2hlcyh1c2VySWQsICdhY3RpdmUnKTtcclxuXHJcbiAgaWYgKCF3YXRjaGVzLmxlbmd0aCkge1xyXG4gICAgcmV0dXJuIFwiWW91IGRvbid0IGhhdmUgYW55IGFjdGl2ZSB3YXRjaGVzLlxcblN0YXJ0IHdpdGg6ICdXYXRjaCBmb3IgW2V2ZW50XSB1bmRlciDigqxbcHJpY2VdJ1wiO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgbGluZXMgPSBbJ1lvdXIgYWN0aXZlIHdhdGNoZXM6XFxuJ107XHJcbiAgd2F0Y2hlcy5mb3JFYWNoKCh3KSA9PiB7XHJcbiAgICBjb25zdCBwcmljZUluZm8gPSB3Lm1heFByaWNlID8gYCAobWF4IOKCrCR7dy5tYXhQcmljZX0pYCA6ICcnO1xyXG4gICAgY29uc3QgY3JlYXRlZCA9IG5ldyBEYXRlKHcuY3JlYXRlZEF0KS50b0xvY2FsZURhdGVTdHJpbmcoJ2VuLUlFJywgeyBkYXk6ICdudW1lcmljJywgbW9udGg6ICdzaG9ydCcgfSk7XHJcbiAgICBsaW5lcy5wdXNoKGAtICR7dy5ldmVudE5hbWV9JHtwcmljZUluZm99XFxuICAke3cucXVhbnRpdHl9eCB0aWNrZXRzLCBjcmVhdGVkICR7Y3JlYXRlZH1gKTtcclxuICB9KTtcclxuXHJcbiAgbGluZXMucHVzaChcIlxcblJlcGx5ICdjYW5jZWwgW2V2ZW50XScgdG8gcmVtb3ZlIGEgd2F0Y2guXCIpO1xyXG4gIHJldHVybiBsaW5lcy5qb2luKCdcXG4nKTtcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlQ2FuY2VsKHVzZXJJZDogc3RyaW5nLCBpbnRlbnRSZXN1bHQ6IGFueSk6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgaWYgKGludGVudFJlc3VsdC5uZWVkc0NsYXJpZmljYXRpb24pIHtcclxuICAgIHJldHVybiBcIldoaWNoIHdhdGNoIGRvIHlvdSB3YW50IHRvIGNhbmNlbD9cXG5SZXBseSB3aXRoOiAnY2FuY2VsIFtldmVudCBuYW1lXSdcIjtcclxuICB9XHJcblxyXG4gIGNvbnN0IGV2ZW50TmFtZSA9IGludGVudFJlc3VsdC5ldmVudE5hbWU7XHJcbiAgY29uc3Qgd2F0Y2hlcyA9IGF3YWl0IGdldFVzZXJXYXRjaGVzKHVzZXJJZCwgJ2FjdGl2ZScpO1xyXG4gIGNvbnN0IG1hdGNoID0gd2F0Y2hlcy5maW5kKCh3KSA9PiB3LmV2ZW50TmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGV2ZW50TmFtZS50b0xvd2VyQ2FzZSgpKSk7XHJcblxyXG4gIGlmICghbWF0Y2gpIHtcclxuICAgIHJldHVybiBgRGlkbid0IGZpbmQgYSB3YXRjaCBmb3IgJyR7ZXZlbnROYW1lfScuXFxuUmVwbHkgJ215IHdhdGNoZXMnIHRvIHNlZSB5b3VyIGFjdGl2ZSBvbmVzLmA7XHJcbiAgfVxyXG5cclxuICBhd2FpdCBjYW5jZWxXYXRjaChtYXRjaC5faWQudG9TdHJpbmcoKSk7XHJcbiAgcmV0dXJuIGBDYW5jZWxsZWQgd2F0Y2ggZm9yICR7bWF0Y2guZXZlbnROYW1lfS5gO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVTdGF0dXModXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gIGNvbnN0IHdhdGNoZXMgPSBhd2FpdCBnZXRVc2VyV2F0Y2hlcyh1c2VySWQsICdhY3RpdmUnKTtcclxuXHJcbiAgaWYgKCF3YXRjaGVzLmxlbmd0aCkge1xyXG4gICAgcmV0dXJuIFwiWW91IGRvbid0IGhhdmUgYW55IGFjdGl2ZSB3YXRjaGVzIHlldC5cIjtcclxuICB9XHJcblxyXG4gIGNvbnN0IGxpbmVzID0gWydDaGVja2luZyB5b3VyIHdhdGNoZXMuLi5cXG4nXTtcclxuXHJcbiAgZm9yIChjb25zdCB3YXRjaCBvZiB3YXRjaGVzKSB7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjaGVja0F2YWlsYWJpbGl0eSh3YXRjaC5ldmVudElkLCB3YXRjaC5tYXhQcmljZSwgd2F0Y2gucXVhbnRpdHkpO1xyXG4gICAgaWYgKHJlc3VsdC5hdmFpbGFibGUpIHtcclxuICAgICAgbGluZXMucHVzaChcclxuICAgICAgICBgKiR7d2F0Y2guZXZlbnROYW1lfSogLSBUSUNLRVRTIEFWQUlMQUJMRSFcXG5gICtcclxuICAgICAgICAgIGAgICBQcmljZTog4oKsJHtyZXN1bHQucHJpY2V9XFxuYCArXHJcbiAgICAgICAgICBgICAgJHtyZXN1bHQuZGV0YWlsc31gXHJcbiAgICAgICk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBsaW5lcy5wdXNoKGAke3dhdGNoLmV2ZW50TmFtZX06ICR7cmVzdWx0LmRldGFpbHN9YCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZXR1cm4gbGluZXMuam9pbignXFxuJyk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUhlbHAoKTogc3RyaW5nIHtcclxuICByZXR1cm4gKFxyXG4gICAgJypUaWNrZXRXYXRjaCBIZWxwKlxcblxcbicgK1xyXG4gICAgJ0kgaGVscCB5b3UgZmluZCBhbmQgd2F0Y2ggZm9yIHNvbGQtb3V0IGNvbmNlcnQgdGlja2V0cyBpbiBJcmVsYW5kIVxcblxcbicgK1xyXG4gICAgJypDb21tYW5kczoqXFxuJyArXHJcbiAgICAnLSBcIldhdGNoIGZvciBbYXJ0aXN0XSB1bmRlciDigqxbcHJpY2VdXCIgLSBDcmVhdGUgYSB0aWNrZXQgd2F0Y2hcXG4nICtcclxuICAgICctIFwiTXkgd2F0Y2hlc1wiIC0gU2VlIHlvdXIgYWN0aXZlIHdhdGNoZXNcXG4nICtcclxuICAgICctIFwiQ2FuY2VsIFthcnRpc3RdXCIgLSBSZW1vdmUgYSB3YXRjaFxcbicgK1xyXG4gICAgJy0gXCJbQXJ0aXN0IG5hbWVdXCIgLSBTZWFyY2ggZm9yIGV2ZW50c1xcbicgK1xyXG4gICAgJy0gXCJBbnkgdXBkYXRlcz9cIiAtIENoZWNrIHlvdXIgd2F0Y2hlcyBmb3IgbmV3IHRpY2tldHNcXG5cXG4nICtcclxuICAgICcqUHJpY2luZzoqXFxuJyArXHJcbiAgICAnRnJlZTogMSBhY3RpdmUgd2F0Y2hcXG4nICtcclxuICAgICdQcmVtaXVtICjigqw0Ljk5L21vKTogVW5saW1pdGVkIHdhdGNoZXNcXG5cXG4nICtcclxuICAgIFwiU2F5ICd3YXRjaCBmb3IgQmljZXAgdW5kZXIg4oKsNzUnIHRvIHN0YXJ0IVwiXHJcbiAgKTtcclxufVxyXG4iXSwibmFtZXMiOlsicGFyc2VJbnRlbnQiLCJjcmVhdGVVc2VyIiwiZ2V0VXNlclRpZXIiLCJjb3VudEFjdGl2ZVdhdGNoZXMiLCJjcmVhdGVXYXRjaCIsImdldFVzZXJXYXRjaGVzIiwiY2FuY2VsV2F0Y2giLCJnZXRDb252ZXJzYXRpb25TdGF0ZSIsInNldENvbnZlcnNhdGlvblN0YXRlIiwic2VhcmNoRXZlbnRzIiwiZm9ybWF0RXZlbnQiLCJjaGVja0F2YWlsYWJpbGl0eSIsIkZSRUVfVElFUl9NQVhfV0FUQ0hFUyIsImhhbmRsZU1lc3NhZ2UiLCJ1c2VySWQiLCJwaG9uZSIsIm1lc3NhZ2VUZXh0Iiwic3RhdGUiLCJhY3Rpb24iLCJpbnRlbnQiLCJoYW5kbGVXYXRjaENvbmZpcm0iLCJkYXRhIiwiaW50ZW50UmVzdWx0IiwiaGFuZGxlU2VhcmNoIiwiaGFuZGxlV2F0Y2giLCJoYW5kbGVMaXN0IiwiaGFuZGxlQ2FuY2VsIiwiaGFuZGxlU3RhdHVzIiwiaGFuZGxlSGVscCIsInF1ZXJ5IiwiZXZlbnRzIiwibGVuZ3RoIiwiZm9ybWF0dGVkIiwic2xpY2UiLCJtYXAiLCJmaWx0ZXIiLCJCb29sZWFuIiwibGluZXMiLCJmb3JFYWNoIiwiZXZlbnQiLCJpIiwic3RhdHVzSWNvbiIsInN0YXR1cyIsInByaWNlIiwicHJpY2VNaW4iLCJwcmljZU1heCIsInB1c2giLCJuYW1lIiwidmVudWUiLCJjaXR5IiwiZGF0ZSIsInRpbWUiLCJqb2luIiwibmVlZHNDbGFyaWZpY2F0aW9uIiwiY2xhcmlmaWNhdGlvbk1lc3NhZ2UiLCJldmVudE5hbWUiLCJtYXhQcmljZSIsInF1YW50aXR5IiwidGllciIsImFjdGl2ZUNvdW50IiwiZm10IiwibWF4UHJpY2VJbmZvIiwiZXZlbnRJZCIsImlkIiwiYnV5VXJsIiwidXJsIiwid2F0Y2hJZCIsInByaWNlSW5mbyIsIndhdGNoZXMiLCJ3IiwiY3JlYXRlZCIsIkRhdGUiLCJjcmVhdGVkQXQiLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJkYXkiLCJtb250aCIsIm1hdGNoIiwiZmluZCIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiLCJfaWQiLCJ0b1N0cmluZyIsIndhdGNoIiwicmVzdWx0IiwiYXZhaWxhYmxlIiwiZGV0YWlscyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/handler.ts\n");

/***/ }),

/***/ "(rsc)/./lib/mongodb.ts":
/*!************************!*\
  !*** ./lib/mongodb.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   cancelWatch: () => (/* binding */ cancelWatch),\n/* harmony export */   countActiveWatches: () => (/* binding */ countActiveWatches),\n/* harmony export */   createUser: () => (/* binding */ createUser),\n/* harmony export */   createWatch: () => (/* binding */ createWatch),\n/* harmony export */   getActiveWatches: () => (/* binding */ getActiveWatches),\n/* harmony export */   getAlertsCollection: () => (/* binding */ getAlertsCollection),\n/* harmony export */   getConversationState: () => (/* binding */ getConversationState),\n/* harmony export */   getDb: () => (/* binding */ getDb),\n/* harmony export */   getUser: () => (/* binding */ getUser),\n/* harmony export */   getUserTier: () => (/* binding */ getUserTier),\n/* harmony export */   getUserWatches: () => (/* binding */ getUserWatches),\n/* harmony export */   getUsersCollection: () => (/* binding */ getUsersCollection),\n/* harmony export */   getWatchesCollection: () => (/* binding */ getWatchesCollection),\n/* harmony export */   recordAlert: () => (/* binding */ recordAlert),\n/* harmony export */   setConversationState: () => (/* binding */ setConversationState),\n/* harmony export */   updateWatchStatus: () => (/* binding */ updateWatchStatus)\n/* harmony export */ });\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongodb */ \"mongodb\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongodb__WEBPACK_IMPORTED_MODULE_0__);\n\nconst MONGODB_URI = process.env.MONGODB_URI || \"\";\nif (!MONGODB_URI) {\n    console.warn(\"MONGODB_URI not set - database operations will fail\");\n}\nlet cached = null;\nasync function getDb() {\n    if (cached) return cached.db;\n    const client = new mongodb__WEBPACK_IMPORTED_MODULE_0__.MongoClient(MONGODB_URI);\n    await client.connect();\n    const db = client.db(\"ticketwatch\");\n    cached = {\n        client,\n        db\n    };\n    return db;\n}\n// Collection helpers\nasync function getUsersCollection() {\n    const db = await getDb();\n    return db.collection(\"users\");\n}\nasync function getWatchesCollection() {\n    const db = await getDb();\n    return db.collection(\"watches\");\n}\nasync function getAlertsCollection() {\n    const db = await getDb();\n    return db.collection(\"alerts\");\n}\n// Database operations (ported from database.py)\nasync function createUser(userId, phone) {\n    const users = await getUsersCollection();\n    await users.updateOne({\n        _id: userId\n    }, {\n        $set: {\n            phone,\n            lastActivity: new Date()\n        },\n        $setOnInsert: {\n            tier: \"free\",\n            createdAt: new Date(),\n            conversationState: null\n        }\n    }, {\n        upsert: true\n    });\n}\nasync function getUser(userId) {\n    const users = await getUsersCollection();\n    return users.findOne({\n        _id: userId\n    });\n}\nasync function getUserTier(userId) {\n    const user = await getUser(userId);\n    return user?.tier || \"free\";\n}\nasync function setConversationState(userId, state) {\n    const users = await getUsersCollection();\n    await users.updateOne({\n        _id: userId\n    }, {\n        $set: {\n            conversationState: state\n        }\n    });\n}\nasync function getConversationState(userId) {\n    const user = await getUser(userId);\n    return user?.conversationState || null;\n}\nasync function createWatch(userId, eventId, eventName, venue, dateStart, maxPrice, quantity, buyUrl) {\n    const watches = await getWatchesCollection();\n    // Check for duplicate\n    const existing = await watches.findOne({\n        userId,\n        eventId,\n        status: \"active\"\n    });\n    if (existing) return null;\n    const result = await watches.insertOne({\n        userId,\n        eventId,\n        eventName,\n        venue,\n        dateStart,\n        maxPrice,\n        quantity,\n        status: \"active\",\n        buyUrl,\n        createdAt: new Date(),\n        lastChecked: null,\n        alertedAt: null\n    });\n    return result.insertedId.toString();\n}\nasync function getUserWatches(userId, status = \"active\") {\n    const watches = await getWatchesCollection();\n    return watches.find({\n        userId,\n        status\n    }).sort({\n        createdAt: -1\n    }).toArray();\n}\nasync function getActiveWatches() {\n    const watches = await getWatchesCollection();\n    return watches.find({\n        status: \"active\"\n    }).sort({\n        lastChecked: 1\n    }).toArray();\n}\nasync function updateWatchStatus(watchId, status) {\n    const watches = await getWatchesCollection();\n    await watches.updateOne({\n        _id: new mongodb__WEBPACK_IMPORTED_MODULE_0__.ObjectId(watchId)\n    }, {\n        $set: {\n            status,\n            lastChecked: new Date()\n        }\n    });\n}\nasync function cancelWatch(watchId) {\n    const watches = await getWatchesCollection();\n    await watches.updateOne({\n        _id: new mongodb__WEBPACK_IMPORTED_MODULE_0__.ObjectId(watchId)\n    }, {\n        $set: {\n            status: \"cancelled\"\n        }\n    });\n}\nasync function countActiveWatches(userId) {\n    const watches = await getWatchesCollection();\n    return watches.countDocuments({\n        userId,\n        status: \"active\"\n    });\n}\nasync function recordAlert(watchId, userId, eventName, currentPrice) {\n    const alerts = await getAlertsCollection();\n    await alerts.insertOne({\n        watchId: new mongodb__WEBPACK_IMPORTED_MODULE_0__.ObjectId(watchId),\n        userId,\n        eventName,\n        currentPrice,\n        sentAt: new Date()\n    });\n    const watches = await getWatchesCollection();\n    await watches.updateOne({\n        _id: new mongodb__WEBPACK_IMPORTED_MODULE_0__.ObjectId(watchId)\n    }, {\n        $set: {\n            status: \"alerted\",\n            alertedAt: new Date()\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUssSUFBSXBCLDZDQUFRQSxDQUFDMkQ7SUFBUyxHQUM3QjtRQUFFdEMsTUFBTTtZQUFFeUIsUUFBUTtZQUFXSSxXQUFXLElBQUkzQjtRQUFPO0lBQUU7QUFFekQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aWNrZXR3YXRjaC1sYW5kaW5nLy4vbGliL21vbmdvZGIudHM/MDViZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBNb25nb0NsaWVudCwgRGIsIENvbGxlY3Rpb24sIE9iamVjdElkIH0gZnJvbSAnbW9uZ29kYic7XHJcblxyXG5jb25zdCBNT05HT0RCX1VSSSA9IHByb2Nlc3MuZW52Lk1PTkdPREJfVVJJIHx8ICcnO1xyXG5cclxuaWYgKCFNT05HT0RCX1VSSSkge1xyXG4gIGNvbnNvbGUud2FybignTU9OR09EQl9VUkkgbm90IHNldCAtIGRhdGFiYXNlIG9wZXJhdGlvbnMgd2lsbCBmYWlsJyk7XHJcbn1cclxuXHJcbmxldCBjYWNoZWQ6IHsgY2xpZW50OiBNb25nb0NsaWVudDsgZGI6IERiIH0gfCBudWxsID0gbnVsbDtcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXREYigpOiBQcm9taXNlPERiPiB7XHJcbiAgaWYgKGNhY2hlZCkgcmV0dXJuIGNhY2hlZC5kYjtcclxuXHJcbiAgY29uc3QgY2xpZW50ID0gbmV3IE1vbmdvQ2xpZW50KE1PTkdPREJfVVJJKTtcclxuICBhd2FpdCBjbGllbnQuY29ubmVjdCgpO1xyXG4gIGNvbnN0IGRiID0gY2xpZW50LmRiKCd0aWNrZXR3YXRjaCcpO1xyXG4gIGNhY2hlZCA9IHsgY2xpZW50LCBkYiB9O1xyXG4gIHJldHVybiBkYjtcclxufVxyXG5cclxuLy8gQ29sbGVjdGlvbiBoZWxwZXJzXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRVc2Vyc0NvbGxlY3Rpb24oKTogUHJvbWlzZTxDb2xsZWN0aW9uPiB7XHJcbiAgY29uc3QgZGIgPSBhd2FpdCBnZXREYigpO1xyXG4gIHJldHVybiBkYi5jb2xsZWN0aW9uKCd1c2VycycpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0V2F0Y2hlc0NvbGxlY3Rpb24oKTogUHJvbWlzZTxDb2xsZWN0aW9uPiB7XHJcbiAgY29uc3QgZGIgPSBhd2FpdCBnZXREYigpO1xyXG4gIHJldHVybiBkYi5jb2xsZWN0aW9uKCd3YXRjaGVzJyk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGVydHNDb2xsZWN0aW9uKCk6IFByb21pc2U8Q29sbGVjdGlvbj4ge1xyXG4gIGNvbnN0IGRiID0gYXdhaXQgZ2V0RGIoKTtcclxuICByZXR1cm4gZGIuY29sbGVjdGlvbignYWxlcnRzJyk7XHJcbn1cclxuXHJcbi8vIERhdGFiYXNlIG9wZXJhdGlvbnMgKHBvcnRlZCBmcm9tIGRhdGFiYXNlLnB5KVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVVzZXIodXNlcklkOiBzdHJpbmcsIHBob25lOiBzdHJpbmcpIHtcclxuICBjb25zdCB1c2VycyA9IGF3YWl0IGdldFVzZXJzQ29sbGVjdGlvbigpO1xyXG4gIGF3YWl0IHVzZXJzLnVwZGF0ZU9uZShcclxuICAgIHsgX2lkOiB1c2VySWQgYXMgYW55IH0sXHJcbiAgICB7XHJcbiAgICAgICRzZXQ6IHsgcGhvbmUsIGxhc3RBY3Rpdml0eTogbmV3IERhdGUoKSB9LFxyXG4gICAgICAkc2V0T25JbnNlcnQ6IHsgdGllcjogJ2ZyZWUnLCBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksIGNvbnZlcnNhdGlvblN0YXRlOiBudWxsIH0sXHJcbiAgICB9LFxyXG4gICAgeyB1cHNlcnQ6IHRydWUgfVxyXG4gICk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRVc2VyKHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgY29uc3QgdXNlcnMgPSBhd2FpdCBnZXRVc2Vyc0NvbGxlY3Rpb24oKTtcclxuICByZXR1cm4gdXNlcnMuZmluZE9uZSh7IF9pZDogdXNlcklkIGFzIGFueSB9KTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFVzZXJUaWVyKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICBjb25zdCB1c2VyID0gYXdhaXQgZ2V0VXNlcih1c2VySWQpO1xyXG4gIHJldHVybiB1c2VyPy50aWVyIHx8ICdmcmVlJztcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNldENvbnZlcnNhdGlvblN0YXRlKHVzZXJJZDogc3RyaW5nLCBzdGF0ZTogYW55KSB7XHJcbiAgY29uc3QgdXNlcnMgPSBhd2FpdCBnZXRVc2Vyc0NvbGxlY3Rpb24oKTtcclxuICBhd2FpdCB1c2Vycy51cGRhdGVPbmUoeyBfaWQ6IHVzZXJJZCBhcyBhbnkgfSwgeyAkc2V0OiB7IGNvbnZlcnNhdGlvblN0YXRlOiBzdGF0ZSB9IH0pO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q29udmVyc2F0aW9uU3RhdGUodXNlcklkOiBzdHJpbmcpIHtcclxuICBjb25zdCB1c2VyID0gYXdhaXQgZ2V0VXNlcih1c2VySWQpO1xyXG4gIHJldHVybiB1c2VyPy5jb252ZXJzYXRpb25TdGF0ZSB8fCBudWxsO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlV2F0Y2goXHJcbiAgdXNlcklkOiBzdHJpbmcsXHJcbiAgZXZlbnRJZDogc3RyaW5nLFxyXG4gIGV2ZW50TmFtZTogc3RyaW5nLFxyXG4gIHZlbnVlOiBzdHJpbmcsXHJcbiAgZGF0ZVN0YXJ0OiBzdHJpbmcsXHJcbiAgbWF4UHJpY2U6IG51bWJlciB8IG51bGwsXHJcbiAgcXVhbnRpdHk6IG51bWJlcixcclxuICBidXlVcmw6IHN0cmluZ1xyXG4pOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcclxuICBjb25zdCB3YXRjaGVzID0gYXdhaXQgZ2V0V2F0Y2hlc0NvbGxlY3Rpb24oKTtcclxuXHJcbiAgLy8gQ2hlY2sgZm9yIGR1cGxpY2F0ZVxyXG4gIGNvbnN0IGV4aXN0aW5nID0gYXdhaXQgd2F0Y2hlcy5maW5kT25lKHsgdXNlcklkLCBldmVudElkLCBzdGF0dXM6ICdhY3RpdmUnIH0pO1xyXG4gIGlmIChleGlzdGluZykgcmV0dXJuIG51bGw7XHJcblxyXG4gIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHdhdGNoZXMuaW5zZXJ0T25lKHtcclxuICAgIHVzZXJJZCxcclxuICAgIGV2ZW50SWQsXHJcbiAgICBldmVudE5hbWUsXHJcbiAgICB2ZW51ZSxcclxuICAgIGRhdGVTdGFydCxcclxuICAgIG1heFByaWNlLFxyXG4gICAgcXVhbnRpdHksXHJcbiAgICBzdGF0dXM6ICdhY3RpdmUnLFxyXG4gICAgYnV5VXJsLFxyXG4gICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxyXG4gICAgbGFzdENoZWNrZWQ6IG51bGwsXHJcbiAgICBhbGVydGVkQXQ6IG51bGwsXHJcbiAgfSk7XHJcblxyXG4gIHJldHVybiByZXN1bHQuaW5zZXJ0ZWRJZC50b1N0cmluZygpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VXNlcldhdGNoZXModXNlcklkOiBzdHJpbmcsIHN0YXR1cyA9ICdhY3RpdmUnKSB7XHJcbiAgY29uc3Qgd2F0Y2hlcyA9IGF3YWl0IGdldFdhdGNoZXNDb2xsZWN0aW9uKCk7XHJcbiAgcmV0dXJuIHdhdGNoZXMuZmluZCh7IHVzZXJJZCwgc3RhdHVzIH0pLnNvcnQoeyBjcmVhdGVkQXQ6IC0xIH0pLnRvQXJyYXkoKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFjdGl2ZVdhdGNoZXMoKSB7XHJcbiAgY29uc3Qgd2F0Y2hlcyA9IGF3YWl0IGdldFdhdGNoZXNDb2xsZWN0aW9uKCk7XHJcbiAgcmV0dXJuIHdhdGNoZXMuZmluZCh7IHN0YXR1czogJ2FjdGl2ZScgfSkuc29ydCh7IGxhc3RDaGVja2VkOiAxIH0pLnRvQXJyYXkoKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVdhdGNoU3RhdHVzKHdhdGNoSWQ6IHN0cmluZywgc3RhdHVzOiBzdHJpbmcpIHtcclxuICBjb25zdCB3YXRjaGVzID0gYXdhaXQgZ2V0V2F0Y2hlc0NvbGxlY3Rpb24oKTtcclxuICBhd2FpdCB3YXRjaGVzLnVwZGF0ZU9uZShcclxuICAgIHsgX2lkOiBuZXcgT2JqZWN0SWQod2F0Y2hJZCkgfSxcclxuICAgIHsgJHNldDogeyBzdGF0dXMsIGxhc3RDaGVja2VkOiBuZXcgRGF0ZSgpIH0gfVxyXG4gICk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjYW5jZWxXYXRjaCh3YXRjaElkOiBzdHJpbmcpIHtcclxuICBjb25zdCB3YXRjaGVzID0gYXdhaXQgZ2V0V2F0Y2hlc0NvbGxlY3Rpb24oKTtcclxuICBhd2FpdCB3YXRjaGVzLnVwZGF0ZU9uZShcclxuICAgIHsgX2lkOiBuZXcgT2JqZWN0SWQod2F0Y2hJZCkgfSxcclxuICAgIHsgJHNldDogeyBzdGF0dXM6ICdjYW5jZWxsZWQnIH0gfVxyXG4gICk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjb3VudEFjdGl2ZVdhdGNoZXModXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPG51bWJlcj4ge1xyXG4gIGNvbnN0IHdhdGNoZXMgPSBhd2FpdCBnZXRXYXRjaGVzQ29sbGVjdGlvbigpO1xyXG4gIHJldHVybiB3YXRjaGVzLmNvdW50RG9jdW1lbnRzKHsgdXNlcklkLCBzdGF0dXM6ICdhY3RpdmUnIH0pO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVjb3JkQWxlcnQoXHJcbiAgd2F0Y2hJZDogc3RyaW5nLFxyXG4gIHVzZXJJZDogc3RyaW5nLFxyXG4gIGV2ZW50TmFtZTogc3RyaW5nLFxyXG4gIGN1cnJlbnRQcmljZTogbnVtYmVyXHJcbikge1xyXG4gIGNvbnN0IGFsZXJ0cyA9IGF3YWl0IGdldEFsZXJ0c0NvbGxlY3Rpb24oKTtcclxuICBhd2FpdCBhbGVydHMuaW5zZXJ0T25lKHtcclxuICAgIHdhdGNoSWQ6IG5ldyBPYmplY3RJZCh3YXRjaElkKSxcclxuICAgIHVzZXJJZCxcclxuICAgIGV2ZW50TmFtZSxcclxuICAgIGN1cnJlbnRQcmljZSxcclxuICAgIHNlbnRBdDogbmV3IERhdGUoKSxcclxuICB9KTtcclxuXHJcbiAgY29uc3Qgd2F0Y2hlcyA9IGF3YWl0IGdldFdhdGNoZXNDb2xsZWN0aW9uKCk7XHJcbiAgYXdhaXQgd2F0Y2hlcy51cGRhdGVPbmUoXHJcbiAgICB7IF9pZDogbmV3IE9iamVjdElkKHdhdGNoSWQpIH0sXHJcbiAgICB7ICRzZXQ6IHsgc3RhdHVzOiAnYWxlcnRlZCcsIGFsZXJ0ZWRBdDogbmV3IERhdGUoKSB9IH1cclxuICApO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJNb25nb0NsaWVudCIsIk9iamVjdElkIiwiTU9OR09EQl9VUkkiLCJwcm9jZXNzIiwiZW52IiwiY29uc29sZSIsIndhcm4iLCJjYWNoZWQiLCJnZXREYiIsImRiIiwiY2xpZW50IiwiY29ubmVjdCIsImdldFVzZXJzQ29sbGVjdGlvbiIsImNvbGxlY3Rpb24iLCJnZXRXYXRjaGVzQ29sbGVjdGlvbiIsImdldEFsZXJ0c0NvbGxlY3Rpb24iLCJjcmVhdGVVc2VyIiwidXNlcklkIiwicGhvbmUiLCJ1c2VycyIsInVwZGF0ZU9uZSIsIl9pZCIsIiRzZXQiLCJsYXN0QWN0aXZpdHkiLCJEYXRlIiwiJHNldE9uSW5zZXJ0IiwidGllciIsImNyZWF0ZWRBdCIsImNvbnZlcnNhdGlvblN0YXRlIiwidXBzZXJ0IiwiZ2V0VXNlciIsImZpbmRPbmUiLCJnZXRVc2VyVGllciIsInVzZXIiLCJzZXRDb252ZXJzYXRpb25TdGF0ZSIsInN0YXRlIiwiZ2V0Q29udmVyc2F0aW9uU3RhdGUiLCJjcmVhdGVXYXRjaCIsImV2ZW50SWQiLCJldmVudE5hbWUiLCJ2ZW51ZSIsImRhdGVTdGFydCIsIm1heFByaWNlIiwicXVhbnRpdHkiLCJidXlVcmwiLCJ3YXRjaGVzIiwiZXhpc3RpbmciLCJzdGF0dXMiLCJyZXN1bHQiLCJpbnNlcnRPbmUiLCJsYXN0Q2hlY2tlZCIsImFsZXJ0ZWRBdCIsImluc2VydGVkSWQiLCJ0b1N0cmluZyIsImdldFVzZXJXYXRjaGVzIiwiZmluZCIsInNvcnQiLCJ0b0FycmF5IiwiZ2V0QWN0aXZlV2F0Y2hlcyIsInVwZGF0ZVdhdGNoU3RhdHVzIiwid2F0Y2hJZCIsImNhbmNlbFdhdGNoIiwiY291bnRBY3RpdmVXYXRjaGVzIiwiY291bnREb2N1bWVudHMiLCJyZWNvcmRBbGVydCIsImN1cnJlbnRQcmljZSIsImFsZXJ0cyIsInNlbnRBdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/mongodb.ts\n");

/***/ }),

/***/ "(rsc)/./lib/parser.ts":
/*!***********************!*\
  !*** ./lib/parser.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   parseIntent: () => (/* binding */ parseIntent)\n/* harmony export */ });\nfunction parseIntent(message) {\n    const msgLower = message.toLowerCase().trim();\n    if ([\n        \"watch\",\n        \"alert\",\n        \"notify\",\n        \"tell me when\",\n        \"let me know when\"\n    ].some((w)=>msgLower.includes(w))) {\n        return parseWatchIntent(message);\n    }\n    if ([\n        \"cancel\",\n        \"stop\",\n        \"remove\",\n        \"unwatch\"\n    ].some((w)=>msgLower.includes(w))) {\n        return parseCancelIntent(message);\n    }\n    if ([\n        \"my watches\",\n        \"list\",\n        \"what am i\",\n        \"check my\",\n        \"active\"\n    ].some((w)=>msgLower.includes(w))) {\n        return {\n            intent: \"list\",\n            confidence: 0.9,\n            needsClarification: false\n        };\n    }\n    if ([\n        \"update\",\n        \"any\",\n        \"news\",\n        \"status\",\n        \"tickets available\"\n    ].some((w)=>msgLower.includes(w))) {\n        return {\n            intent: \"status\",\n            confidence: 0.8,\n            needsClarification: false\n        };\n    }\n    if ([\n        \"yes\",\n        \"yeah\",\n        \"yep\",\n        \"confirm\",\n        \"go ahead\",\n        \"do it\"\n    ].some((w)=>msgLower.includes(w))) {\n        return {\n            intent: \"confirm\",\n            confidence: 0.9,\n            needsClarification: false\n        };\n    }\n    if ([\n        \"no\",\n        \"nah\",\n        \"nevermind\",\n        \"skip\"\n    ].some((w)=>msgLower.includes(w))) {\n        return {\n            intent: \"deny\",\n            confidence: 0.9,\n            needsClarification: false\n        };\n    }\n    if ([\n        \"gig\",\n        \"concert\",\n        \"event\",\n        \"playing\",\n        \"what's\",\n        \"show\",\n        \"tour\"\n    ].some((w)=>msgLower.includes(w))) {\n        return {\n            intent: \"search\",\n            confidence: 0.7,\n            query: message,\n            needsClarification: false\n        };\n    }\n    if ([\n        \"help\",\n        \"how\",\n        \"?\"\n    ].some((w)=>msgLower.includes(w))) {\n        return {\n            intent: \"help\",\n            confidence: 0.9,\n            needsClarification: false\n        };\n    }\n    // Default: treat as search\n    return {\n        intent: \"search\",\n        confidence: 0.5,\n        query: message,\n        needsClarification: false\n    };\n}\nfunction parseWatchIntent(message) {\n    const match = message.match(/(?:watch|alert|notify)(?:\\s+(?:for|me|when))?\\s+(?:(\\d+)\\s+)?(?:tickets?\\s+)?(?:for\\s+)?(?:to\\s+)?([^€\\n]+?)(?:\\s+(?:under|below|max|less than|<)?\\s*€?(\\d+))?$/i);\n    let eventName = null;\n    let quantity = 1;\n    let maxPrice = null;\n    if (match) {\n        quantity = match[1] ? parseInt(match[1]) : 1;\n        eventName = match[2]?.trim() || null;\n        maxPrice = match[3] ? parseFloat(match[3]) : null;\n    }\n    return {\n        intent: \"watch\",\n        confidence: eventName ? 0.7 : 0.5,\n        eventName,\n        maxPrice,\n        quantity,\n        needsClarification: !eventName,\n        clarificationMessage: !eventName ? \"What event do you want to watch for?\" : null\n    };\n}\nfunction parseCancelIntent(message) {\n    const match = message.match(/cancel(?:\\s+(?:watch|for))?\\s+([^.!?\\n]+)?/i);\n    const eventName = match?.[1]?.trim() || null;\n    return {\n        intent: \"cancel\",\n        confidence: 0.8,\n        eventName,\n        needsClarification: !eventName,\n        clarificationMessage: !eventName ? \"Which watch do you want to cancel? (or 'my watches' to see all)\" : null\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O0lBQzVCLE1BQU1DLFlBQVlELE9BQU8sQ0FBQyxFQUFFLEVBQUVWLFVBQVU7SUFFeEMsT0FBTztRQUNMTSxRQUFRO1FBQ1JDLFlBQVk7UUFDWkk7UUFDQUgsb0JBQW9CLENBQUNHO1FBQ3JCSyxzQkFBc0IsQ0FBQ0wsWUFDbkIsb0VBQ0E7SUFDTjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGlja2V0d2F0Y2gtbGFuZGluZy8uL2xpYi9wYXJzZXIudHM/NGE2MSJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgaW50ZXJmYWNlIFBhcnNlZEludGVudCB7XHJcbiAgaW50ZW50OiBzdHJpbmc7XHJcbiAgY29uZmlkZW5jZTogbnVtYmVyO1xyXG4gIGV2ZW50TmFtZT86IHN0cmluZyB8IG51bGw7XHJcbiAgbWF4UHJpY2U/OiBudW1iZXIgfCBudWxsO1xyXG4gIHF1YW50aXR5PzogbnVtYmVyIHwgbnVsbDtcclxuICBxdWVyeT86IHN0cmluZztcclxuICBuZWVkc0NsYXJpZmljYXRpb246IGJvb2xlYW47XHJcbiAgY2xhcmlmaWNhdGlvbk1lc3NhZ2U/OiBzdHJpbmcgfCBudWxsO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VJbnRlbnQobWVzc2FnZTogc3RyaW5nKTogUGFyc2VkSW50ZW50IHtcclxuICBjb25zdCBtc2dMb3dlciA9IG1lc3NhZ2UudG9Mb3dlckNhc2UoKS50cmltKCk7XHJcblxyXG4gIGlmIChbJ3dhdGNoJywgJ2FsZXJ0JywgJ25vdGlmeScsICd0ZWxsIG1lIHdoZW4nLCAnbGV0IG1lIGtub3cgd2hlbiddLnNvbWUoKHcpID0+IG1zZ0xvd2VyLmluY2x1ZGVzKHcpKSkge1xyXG4gICAgcmV0dXJuIHBhcnNlV2F0Y2hJbnRlbnQobWVzc2FnZSk7XHJcbiAgfVxyXG4gIGlmIChbJ2NhbmNlbCcsICdzdG9wJywgJ3JlbW92ZScsICd1bndhdGNoJ10uc29tZSgodykgPT4gbXNnTG93ZXIuaW5jbHVkZXModykpKSB7XHJcbiAgICByZXR1cm4gcGFyc2VDYW5jZWxJbnRlbnQobWVzc2FnZSk7XHJcbiAgfVxyXG4gIGlmIChbJ215IHdhdGNoZXMnLCAnbGlzdCcsICd3aGF0IGFtIGknLCAnY2hlY2sgbXknLCAnYWN0aXZlJ10uc29tZSgodykgPT4gbXNnTG93ZXIuaW5jbHVkZXModykpKSB7XHJcbiAgICByZXR1cm4geyBpbnRlbnQ6ICdsaXN0JywgY29uZmlkZW5jZTogMC45LCBuZWVkc0NsYXJpZmljYXRpb246IGZhbHNlIH07XHJcbiAgfVxyXG4gIGlmIChbJ3VwZGF0ZScsICdhbnknLCAnbmV3cycsICdzdGF0dXMnLCAndGlja2V0cyBhdmFpbGFibGUnXS5zb21lKCh3KSA9PiBtc2dMb3dlci5pbmNsdWRlcyh3KSkpIHtcclxuICAgIHJldHVybiB7IGludGVudDogJ3N0YXR1cycsIGNvbmZpZGVuY2U6IDAuOCwgbmVlZHNDbGFyaWZpY2F0aW9uOiBmYWxzZSB9O1xyXG4gIH1cclxuICBpZiAoWyd5ZXMnLCAneWVhaCcsICd5ZXAnLCAnY29uZmlybScsICdnbyBhaGVhZCcsICdkbyBpdCddLnNvbWUoKHcpID0+IG1zZ0xvd2VyLmluY2x1ZGVzKHcpKSkge1xyXG4gICAgcmV0dXJuIHsgaW50ZW50OiAnY29uZmlybScsIGNvbmZpZGVuY2U6IDAuOSwgbmVlZHNDbGFyaWZpY2F0aW9uOiBmYWxzZSB9O1xyXG4gIH1cclxuICBpZiAoWydubycsICduYWgnLCAnbmV2ZXJtaW5kJywgJ3NraXAnXS5zb21lKCh3KSA9PiBtc2dMb3dlci5pbmNsdWRlcyh3KSkpIHtcclxuICAgIHJldHVybiB7IGludGVudDogJ2RlbnknLCBjb25maWRlbmNlOiAwLjksIG5lZWRzQ2xhcmlmaWNhdGlvbjogZmFsc2UgfTtcclxuICB9XHJcbiAgaWYgKFsnZ2lnJywgJ2NvbmNlcnQnLCAnZXZlbnQnLCAncGxheWluZycsIFwid2hhdCdzXCIsICdzaG93JywgJ3RvdXInXS5zb21lKCh3KSA9PiBtc2dMb3dlci5pbmNsdWRlcyh3KSkpIHtcclxuICAgIHJldHVybiB7IGludGVudDogJ3NlYXJjaCcsIGNvbmZpZGVuY2U6IDAuNywgcXVlcnk6IG1lc3NhZ2UsIG5lZWRzQ2xhcmlmaWNhdGlvbjogZmFsc2UgfTtcclxuICB9XHJcbiAgaWYgKFsnaGVscCcsICdob3cnLCAnPyddLnNvbWUoKHcpID0+IG1zZ0xvd2VyLmluY2x1ZGVzKHcpKSkge1xyXG4gICAgcmV0dXJuIHsgaW50ZW50OiAnaGVscCcsIGNvbmZpZGVuY2U6IDAuOSwgbmVlZHNDbGFyaWZpY2F0aW9uOiBmYWxzZSB9O1xyXG4gIH1cclxuXHJcbiAgLy8gRGVmYXVsdDogdHJlYXQgYXMgc2VhcmNoXHJcbiAgcmV0dXJuIHtcclxuICAgIGludGVudDogJ3NlYXJjaCcsXHJcbiAgICBjb25maWRlbmNlOiAwLjUsXHJcbiAgICBxdWVyeTogbWVzc2FnZSxcclxuICAgIG5lZWRzQ2xhcmlmaWNhdGlvbjogZmFsc2UsXHJcbiAgfTtcclxufVxyXG5cclxuZnVuY3Rpb24gcGFyc2VXYXRjaEludGVudChtZXNzYWdlOiBzdHJpbmcpOiBQYXJzZWRJbnRlbnQge1xyXG4gIGNvbnN0IG1hdGNoID0gbWVzc2FnZS5tYXRjaChcclxuICAgIC8oPzp3YXRjaHxhbGVydHxub3RpZnkpKD86XFxzKyg/OmZvcnxtZXx3aGVuKSk/XFxzKyg/OihcXGQrKVxccyspPyg/OnRpY2tldHM/XFxzKyk/KD86Zm9yXFxzKyk/KD86dG9cXHMrKT8oW17igqxcXG5dKz8pKD86XFxzKyg/OnVuZGVyfGJlbG93fG1heHxsZXNzIHRoYW58PCk/XFxzKuKCrD8oXFxkKykpPyQvaVxyXG4gICk7XHJcblxyXG4gIGxldCBldmVudE5hbWU6IHN0cmluZyB8IG51bGwgPSBudWxsO1xyXG4gIGxldCBxdWFudGl0eSA9IDE7XHJcbiAgbGV0IG1heFByaWNlOiBudW1iZXIgfCBudWxsID0gbnVsbDtcclxuXHJcbiAgaWYgKG1hdGNoKSB7XHJcbiAgICBxdWFudGl0eSA9IG1hdGNoWzFdID8gcGFyc2VJbnQobWF0Y2hbMV0pIDogMTtcclxuICAgIGV2ZW50TmFtZSA9IG1hdGNoWzJdPy50cmltKCkgfHwgbnVsbDtcclxuICAgIG1heFByaWNlID0gbWF0Y2hbM10gPyBwYXJzZUZsb2F0KG1hdGNoWzNdKSA6IG51bGw7XHJcbiAgfVxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgaW50ZW50OiAnd2F0Y2gnLFxyXG4gICAgY29uZmlkZW5jZTogZXZlbnROYW1lID8gMC43IDogMC41LFxyXG4gICAgZXZlbnROYW1lLFxyXG4gICAgbWF4UHJpY2UsXHJcbiAgICBxdWFudGl0eSxcclxuICAgIG5lZWRzQ2xhcmlmaWNhdGlvbjogIWV2ZW50TmFtZSxcclxuICAgIGNsYXJpZmljYXRpb25NZXNzYWdlOiAhZXZlbnROYW1lID8gJ1doYXQgZXZlbnQgZG8geW91IHdhbnQgdG8gd2F0Y2ggZm9yPycgOiBudWxsLFxyXG4gIH07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHBhcnNlQ2FuY2VsSW50ZW50KG1lc3NhZ2U6IHN0cmluZyk6IFBhcnNlZEludGVudCB7XHJcbiAgY29uc3QgbWF0Y2ggPSBtZXNzYWdlLm1hdGNoKC9jYW5jZWwoPzpcXHMrKD86d2F0Y2h8Zm9yKSk/XFxzKyhbXi4hP1xcbl0rKT8vaSk7XHJcbiAgY29uc3QgZXZlbnROYW1lID0gbWF0Y2g/LlsxXT8udHJpbSgpIHx8IG51bGw7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBpbnRlbnQ6ICdjYW5jZWwnLFxyXG4gICAgY29uZmlkZW5jZTogMC44LFxyXG4gICAgZXZlbnROYW1lLFxyXG4gICAgbmVlZHNDbGFyaWZpY2F0aW9uOiAhZXZlbnROYW1lLFxyXG4gICAgY2xhcmlmaWNhdGlvbk1lc3NhZ2U6ICFldmVudE5hbWVcclxuICAgICAgPyBcIldoaWNoIHdhdGNoIGRvIHlvdSB3YW50IHRvIGNhbmNlbD8gKG9yICdteSB3YXRjaGVzJyB0byBzZWUgYWxsKVwiXHJcbiAgICAgIDogbnVsbCxcclxuICB9O1xyXG59XHJcbiJdLCJuYW1lcyI6WyJwYXJzZUludGVudCIsIm1lc3NhZ2UiLCJtc2dMb3dlciIsInRvTG93ZXJDYXNlIiwidHJpbSIsInNvbWUiLCJ3IiwiaW5jbHVkZXMiLCJwYXJzZVdhdGNoSW50ZW50IiwicGFyc2VDYW5jZWxJbnRlbnQiLCJpbnRlbnQiLCJjb25maWRlbmNlIiwibmVlZHNDbGFyaWZpY2F0aW9uIiwicXVlcnkiLCJtYXRjaCIsImV2ZW50TmFtZSIsInF1YW50aXR5IiwibWF4UHJpY2UiLCJwYXJzZUludCIsInBhcnNlRmxvYXQiLCJjbGFyaWZpY2F0aW9uTWVzc2FnZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/parser.ts\n");

/***/ }),

/***/ "(rsc)/./lib/ticketmaster.ts":
/*!*****************************!*\
  !*** ./lib/ticketmaster.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkAvailability: () => (/* binding */ checkAvailability),\n/* harmony export */   formatEvent: () => (/* binding */ formatEvent),\n/* harmony export */   getEvent: () => (/* binding */ getEvent),\n/* harmony export */   searchEvents: () => (/* binding */ searchEvents)\n/* harmony export */ });\nconst TM_API_KEY = process.env.TICKETMASTER_API_KEY || \"\";\nconst TM_BASE_URL = \"https://app.ticketmaster.com/discovery/v2\";\nconst TM_COUNTRY_CODE = \"IE\";\nconst TM_TIMEOUT = 10000;\nconst DEMO_MODE = !TM_API_KEY;\n// Mock data for testing without API key\nconst MOCK_EVENTS = [\n    {\n        id: \"Z698xZaZeEe11\",\n        name: \"Fred Again\",\n        dates: {\n            start: {\n                localDate: \"2026-03-15\",\n                localTime: \"20:00\"\n            },\n            status: {\n                code: \"onsale\"\n            }\n        },\n        _embedded: {\n            venues: [\n                {\n                    name: \"3Arena Dublin\",\n                    city: {\n                        name: \"Dublin\"\n                    }\n                }\n            ]\n        },\n        priceRanges: [\n            {\n                min: 65.0,\n                max: 145.0\n            }\n        ],\n        url: \"https://www.ticketmaster.ie/fred-again-dublin-03-15-2026/event/12345\"\n    },\n    {\n        id: \"Z123xZaZeEe22\",\n        name: \"The 1975\",\n        dates: {\n            start: {\n                localDate: \"2026-04-20\",\n                localTime: \"19:30\"\n            },\n            status: {\n                code: \"offsale\"\n            }\n        },\n        _embedded: {\n            venues: [\n                {\n                    name: \"O2 Dublin\",\n                    city: {\n                        name: \"Dublin\"\n                    }\n                }\n            ]\n        },\n        priceRanges: [\n            {\n                min: 75.0,\n                max: 125.0\n            }\n        ],\n        url: \"https://www.ticketmaster.ie/the-1975-dublin-04-20-2026/event/67890\"\n    },\n    {\n        id: \"Z456xZaZeEe33\",\n        name: \"Electric Picnic\",\n        dates: {\n            start: {\n                localDate: \"2026-09-05\",\n                localTime: \"11:00\"\n            },\n            status: {\n                code: \"offsale\"\n            }\n        },\n        _embedded: {\n            venues: [\n                {\n                    name: \"Laois Picnic\",\n                    city: {\n                        name: \"Laois\"\n                    }\n                }\n            ]\n        },\n        priceRanges: [\n            {\n                min: 125.0,\n                max: 185.0\n            }\n        ],\n        url: \"https://www.ticketmaster.ie/electric-picnic-laois-09-05-2026/event/11111\"\n    }\n];\nasync function searchEvents(query, size = 10) {\n    if (DEMO_MODE) {\n        const q = query.toLowerCase();\n        const results = MOCK_EVENTS.filter((e)=>e.name.toLowerCase().includes(q));\n        return results.length > 0 ? results : MOCK_EVENTS.slice(0, 3);\n    }\n    const params = new URLSearchParams({\n        apikey: TM_API_KEY,\n        keyword: query,\n        countryCode: TM_COUNTRY_CODE,\n        size: String(size),\n        sort: \"date,asc\"\n    });\n    try {\n        const resp = await fetch(`${TM_BASE_URL}/events.json?${params}`, {\n            signal: AbortSignal.timeout(TM_TIMEOUT)\n        });\n        if (!resp.ok) return [];\n        const data = await resp.json();\n        return data?._embedded?.events || [];\n    } catch  {\n        return [];\n    }\n}\nasync function getEvent(eventId) {\n    if (DEMO_MODE) {\n        return MOCK_EVENTS.find((e)=>e.id === eventId) || null;\n    }\n    const params = new URLSearchParams({\n        apikey: TM_API_KEY\n    });\n    try {\n        const resp = await fetch(`${TM_BASE_URL}/events/${eventId}.json?${params}`, {\n            signal: AbortSignal.timeout(TM_TIMEOUT)\n        });\n        if (!resp.ok) return null;\n        return resp.json();\n    } catch  {\n        return null;\n    }\n}\nfunction formatEvent(event) {\n    if (!event) return null;\n    let venue = \"TBA\";\n    let city = \"\";\n    if (event._embedded?.venues?.[0]) {\n        venue = event._embedded.venues[0].name || \"TBA\";\n        city = event._embedded.venues[0].city?.name || \"\";\n    }\n    const dates = event.dates?.start || {};\n    const priceMin = event.priceRanges?.[0]?.min ?? null;\n    const priceMax = event.priceRanges?.[0]?.max ?? null;\n    const status = event.dates?.status?.code || \"unknown\";\n    return {\n        id: event.id,\n        name: event.name,\n        venue,\n        city,\n        date: dates.localDate || \"TBA\",\n        time: dates.localTime || \"\",\n        priceMin,\n        priceMax,\n        status,\n        url: event.url || \"\"\n    };\n}\nasync function checkAvailability(eventId, maxPrice, quantity) {\n    const event = await getEvent(eventId);\n    if (!event) {\n        return {\n            available: false,\n            status: \"not_found\",\n            details: \"Event not found\"\n        };\n    }\n    const eventStatus = event.dates?.status?.code || \"unknown\";\n    if (eventStatus !== \"onsale\") {\n        return {\n            available: false,\n            status: eventStatus,\n            details: `Event status: ${eventStatus}`\n        };\n    }\n    const priceRanges = event.priceRanges || [];\n    if (!priceRanges.length) {\n        return {\n            available: false,\n            status: \"no_pricing\",\n            details: \"No pricing information available\"\n        };\n    }\n    const minPrice = priceRanges[0].min;\n    const maxAvailable = priceRanges[0].max;\n    if (maxPrice && minPrice) {\n        if (minPrice <= maxPrice) {\n            return {\n                available: true,\n                status: \"onsale\",\n                price: minPrice,\n                priceMax: maxAvailable,\n                details: `Tickets available from €${minPrice}`\n            };\n        }\n        return {\n            available: false,\n            status: \"above_target\",\n            price: minPrice,\n            details: `Cheapest ticket €${minPrice} (your target: €${maxPrice})`\n        };\n    }\n    return {\n        available: true,\n        status: \"onsale\",\n        price: minPrice,\n        priceMax: maxAvailable,\n        details: `Tickets available from €${minPrice}`\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UyxDQUFDLHdCQUF3QixFQUFFRSxTQUFTLENBQUM7SUFDaEQ7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3RpY2tldHdhdGNoLWxhbmRpbmcvLi9saWIvdGlja2V0bWFzdGVyLnRzP2NmNjkiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgVE1fQVBJX0tFWSA9IHByb2Nlc3MuZW52LlRJQ0tFVE1BU1RFUl9BUElfS0VZIHx8ICcnO1xyXG5jb25zdCBUTV9CQVNFX1VSTCA9ICdodHRwczovL2FwcC50aWNrZXRtYXN0ZXIuY29tL2Rpc2NvdmVyeS92Mic7XHJcbmNvbnN0IFRNX0NPVU5UUllfQ09ERSA9ICdJRSc7XHJcbmNvbnN0IFRNX1RJTUVPVVQgPSAxMDAwMDtcclxuXHJcbmNvbnN0IERFTU9fTU9ERSA9ICFUTV9BUElfS0VZO1xyXG5cclxuLy8gTW9jayBkYXRhIGZvciB0ZXN0aW5nIHdpdGhvdXQgQVBJIGtleVxyXG5jb25zdCBNT0NLX0VWRU5UUyA9IFtcclxuICB7XHJcbiAgICBpZDogJ1o2OTh4WmFaZUVlMTEnLFxyXG4gICAgbmFtZTogJ0ZyZWQgQWdhaW4nLFxyXG4gICAgZGF0ZXM6IHsgc3RhcnQ6IHsgbG9jYWxEYXRlOiAnMjAyNi0wMy0xNScsIGxvY2FsVGltZTogJzIwOjAwJyB9LCBzdGF0dXM6IHsgY29kZTogJ29uc2FsZScgfSB9LFxyXG4gICAgX2VtYmVkZGVkOiB7IHZlbnVlczogW3sgbmFtZTogJzNBcmVuYSBEdWJsaW4nLCBjaXR5OiB7IG5hbWU6ICdEdWJsaW4nIH0gfV0gfSxcclxuICAgIHByaWNlUmFuZ2VzOiBbeyBtaW46IDY1LjAsIG1heDogMTQ1LjAgfV0sXHJcbiAgICB1cmw6ICdodHRwczovL3d3dy50aWNrZXRtYXN0ZXIuaWUvZnJlZC1hZ2Fpbi1kdWJsaW4tMDMtMTUtMjAyNi9ldmVudC8xMjM0NScsXHJcbiAgfSxcclxuICB7XHJcbiAgICBpZDogJ1oxMjN4WmFaZUVlMjInLFxyXG4gICAgbmFtZTogJ1RoZSAxOTc1JyxcclxuICAgIGRhdGVzOiB7IHN0YXJ0OiB7IGxvY2FsRGF0ZTogJzIwMjYtMDQtMjAnLCBsb2NhbFRpbWU6ICcxOTozMCcgfSwgc3RhdHVzOiB7IGNvZGU6ICdvZmZzYWxlJyB9IH0sXHJcbiAgICBfZW1iZWRkZWQ6IHsgdmVudWVzOiBbeyBuYW1lOiAnTzIgRHVibGluJywgY2l0eTogeyBuYW1lOiAnRHVibGluJyB9IH1dIH0sXHJcbiAgICBwcmljZVJhbmdlczogW3sgbWluOiA3NS4wLCBtYXg6IDEyNS4wIH1dLFxyXG4gICAgdXJsOiAnaHR0cHM6Ly93d3cudGlja2V0bWFzdGVyLmllL3RoZS0xOTc1LWR1Ymxpbi0wNC0yMC0yMDI2L2V2ZW50LzY3ODkwJyxcclxuICB9LFxyXG4gIHtcclxuICAgIGlkOiAnWjQ1NnhaYVplRWUzMycsXHJcbiAgICBuYW1lOiAnRWxlY3RyaWMgUGljbmljJyxcclxuICAgIGRhdGVzOiB7IHN0YXJ0OiB7IGxvY2FsRGF0ZTogJzIwMjYtMDktMDUnLCBsb2NhbFRpbWU6ICcxMTowMCcgfSwgc3RhdHVzOiB7IGNvZGU6ICdvZmZzYWxlJyB9IH0sXHJcbiAgICBfZW1iZWRkZWQ6IHsgdmVudWVzOiBbeyBuYW1lOiAnTGFvaXMgUGljbmljJywgY2l0eTogeyBuYW1lOiAnTGFvaXMnIH0gfV0gfSxcclxuICAgIHByaWNlUmFuZ2VzOiBbeyBtaW46IDEyNS4wLCBtYXg6IDE4NS4wIH1dLFxyXG4gICAgdXJsOiAnaHR0cHM6Ly93d3cudGlja2V0bWFzdGVyLmllL2VsZWN0cmljLXBpY25pYy1sYW9pcy0wOS0wNS0yMDI2L2V2ZW50LzExMTExJyxcclxuICB9LFxyXG5dO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBGb3JtYXR0ZWRFdmVudCB7XHJcbiAgaWQ6IHN0cmluZztcclxuICBuYW1lOiBzdHJpbmc7XHJcbiAgdmVudWU6IHN0cmluZztcclxuICBjaXR5OiBzdHJpbmc7XHJcbiAgZGF0ZTogc3RyaW5nO1xyXG4gIHRpbWU6IHN0cmluZztcclxuICBwcmljZU1pbjogbnVtYmVyIHwgbnVsbDtcclxuICBwcmljZU1heDogbnVtYmVyIHwgbnVsbDtcclxuICBzdGF0dXM6IHN0cmluZztcclxuICB1cmw6IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlYXJjaEV2ZW50cyhxdWVyeTogc3RyaW5nLCBzaXplID0gMTApOiBQcm9taXNlPGFueVtdPiB7XHJcbiAgaWYgKERFTU9fTU9ERSkge1xyXG4gICAgY29uc3QgcSA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7XHJcbiAgICBjb25zdCByZXN1bHRzID0gTU9DS19FVkVOVFMuZmlsdGVyKChlKSA9PiBlLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxKSk7XHJcbiAgICByZXR1cm4gcmVzdWx0cy5sZW5ndGggPiAwID8gcmVzdWx0cyA6IE1PQ0tfRVZFTlRTLnNsaWNlKDAsIDMpO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh7XHJcbiAgICBhcGlrZXk6IFRNX0FQSV9LRVksXHJcbiAgICBrZXl3b3JkOiBxdWVyeSxcclxuICAgIGNvdW50cnlDb2RlOiBUTV9DT1VOVFJZX0NPREUsXHJcbiAgICBzaXplOiBTdHJpbmcoc2l6ZSksXHJcbiAgICBzb3J0OiAnZGF0ZSxhc2MnLFxyXG4gIH0pO1xyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgcmVzcCA9IGF3YWl0IGZldGNoKGAke1RNX0JBU0VfVVJMfS9ldmVudHMuanNvbj8ke3BhcmFtc31gLCB7XHJcbiAgICAgIHNpZ25hbDogQWJvcnRTaWduYWwudGltZW91dChUTV9USU1FT1VUKSxcclxuICAgIH0pO1xyXG4gICAgaWYgKCFyZXNwLm9rKSByZXR1cm4gW107XHJcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcC5qc29uKCk7XHJcbiAgICByZXR1cm4gZGF0YT8uX2VtYmVkZGVkPy5ldmVudHMgfHwgW107XHJcbiAgfSBjYXRjaCB7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RXZlbnQoZXZlbnRJZDogc3RyaW5nKTogUHJvbWlzZTxhbnkgfCBudWxsPiB7XHJcbiAgaWYgKERFTU9fTU9ERSkge1xyXG4gICAgcmV0dXJuIE1PQ0tfRVZFTlRTLmZpbmQoKGUpID0+IGUuaWQgPT09IGV2ZW50SWQpIHx8IG51bGw7XHJcbiAgfVxyXG5cclxuICBjb25zdCBwYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHsgYXBpa2V5OiBUTV9BUElfS0VZIH0pO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCByZXNwID0gYXdhaXQgZmV0Y2goYCR7VE1fQkFTRV9VUkx9L2V2ZW50cy8ke2V2ZW50SWR9Lmpzb24/JHtwYXJhbXN9YCwge1xyXG4gICAgICBzaWduYWw6IEFib3J0U2lnbmFsLnRpbWVvdXQoVE1fVElNRU9VVCksXHJcbiAgICB9KTtcclxuICAgIGlmICghcmVzcC5vaykgcmV0dXJuIG51bGw7XHJcbiAgICByZXR1cm4gcmVzcC5qc29uKCk7XHJcbiAgfSBjYXRjaCB7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXRFdmVudChldmVudDogYW55KTogRm9ybWF0dGVkRXZlbnQgfCBudWxsIHtcclxuICBpZiAoIWV2ZW50KSByZXR1cm4gbnVsbDtcclxuXHJcbiAgbGV0IHZlbnVlID0gJ1RCQSc7XHJcbiAgbGV0IGNpdHkgPSAnJztcclxuICBpZiAoZXZlbnQuX2VtYmVkZGVkPy52ZW51ZXM/LlswXSkge1xyXG4gICAgdmVudWUgPSBldmVudC5fZW1iZWRkZWQudmVudWVzWzBdLm5hbWUgfHwgJ1RCQSc7XHJcbiAgICBjaXR5ID0gZXZlbnQuX2VtYmVkZGVkLnZlbnVlc1swXS5jaXR5Py5uYW1lIHx8ICcnO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgZGF0ZXMgPSBldmVudC5kYXRlcz8uc3RhcnQgfHwge307XHJcbiAgY29uc3QgcHJpY2VNaW4gPSBldmVudC5wcmljZVJhbmdlcz8uWzBdPy5taW4gPz8gbnVsbDtcclxuICBjb25zdCBwcmljZU1heCA9IGV2ZW50LnByaWNlUmFuZ2VzPy5bMF0/Lm1heCA/PyBudWxsO1xyXG4gIGNvbnN0IHN0YXR1cyA9IGV2ZW50LmRhdGVzPy5zdGF0dXM/LmNvZGUgfHwgJ3Vua25vd24nO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgaWQ6IGV2ZW50LmlkLFxyXG4gICAgbmFtZTogZXZlbnQubmFtZSxcclxuICAgIHZlbnVlLFxyXG4gICAgY2l0eSxcclxuICAgIGRhdGU6IGRhdGVzLmxvY2FsRGF0ZSB8fCAnVEJBJyxcclxuICAgIHRpbWU6IGRhdGVzLmxvY2FsVGltZSB8fCAnJyxcclxuICAgIHByaWNlTWluLFxyXG4gICAgcHJpY2VNYXgsXHJcbiAgICBzdGF0dXMsXHJcbiAgICB1cmw6IGV2ZW50LnVybCB8fCAnJyxcclxuICB9O1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2hlY2tBdmFpbGFiaWxpdHkoXHJcbiAgZXZlbnRJZDogc3RyaW5nLFxyXG4gIG1heFByaWNlOiBudW1iZXIgfCBudWxsLFxyXG4gIHF1YW50aXR5OiBudW1iZXJcclxuKTogUHJvbWlzZTx7IGF2YWlsYWJsZTogYm9vbGVhbjsgcHJpY2U/OiBudW1iZXI7IHByaWNlTWF4PzogbnVtYmVyOyBzdGF0dXM6IHN0cmluZzsgZGV0YWlsczogc3RyaW5nIH0+IHtcclxuICBjb25zdCBldmVudCA9IGF3YWl0IGdldEV2ZW50KGV2ZW50SWQpO1xyXG4gIGlmICghZXZlbnQpIHtcclxuICAgIHJldHVybiB7IGF2YWlsYWJsZTogZmFsc2UsIHN0YXR1czogJ25vdF9mb3VuZCcsIGRldGFpbHM6ICdFdmVudCBub3QgZm91bmQnIH07XHJcbiAgfVxyXG5cclxuICBjb25zdCBldmVudFN0YXR1cyA9IGV2ZW50LmRhdGVzPy5zdGF0dXM/LmNvZGUgfHwgJ3Vua25vd24nO1xyXG4gIGlmIChldmVudFN0YXR1cyAhPT0gJ29uc2FsZScpIHtcclxuICAgIHJldHVybiB7IGF2YWlsYWJsZTogZmFsc2UsIHN0YXR1czogZXZlbnRTdGF0dXMsIGRldGFpbHM6IGBFdmVudCBzdGF0dXM6ICR7ZXZlbnRTdGF0dXN9YCB9O1xyXG4gIH1cclxuXHJcbiAgY29uc3QgcHJpY2VSYW5nZXMgPSBldmVudC5wcmljZVJhbmdlcyB8fCBbXTtcclxuICBpZiAoIXByaWNlUmFuZ2VzLmxlbmd0aCkge1xyXG4gICAgcmV0dXJuIHsgYXZhaWxhYmxlOiBmYWxzZSwgc3RhdHVzOiAnbm9fcHJpY2luZycsIGRldGFpbHM6ICdObyBwcmljaW5nIGluZm9ybWF0aW9uIGF2YWlsYWJsZScgfTtcclxuICB9XHJcblxyXG4gIGNvbnN0IG1pblByaWNlID0gcHJpY2VSYW5nZXNbMF0ubWluO1xyXG4gIGNvbnN0IG1heEF2YWlsYWJsZSA9IHByaWNlUmFuZ2VzWzBdLm1heDtcclxuXHJcbiAgaWYgKG1heFByaWNlICYmIG1pblByaWNlKSB7XHJcbiAgICBpZiAobWluUHJpY2UgPD0gbWF4UHJpY2UpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBhdmFpbGFibGU6IHRydWUsXHJcbiAgICAgICAgc3RhdHVzOiAnb25zYWxlJyxcclxuICAgICAgICBwcmljZTogbWluUHJpY2UsXHJcbiAgICAgICAgcHJpY2VNYXg6IG1heEF2YWlsYWJsZSxcclxuICAgICAgICBkZXRhaWxzOiBgVGlja2V0cyBhdmFpbGFibGUgZnJvbSDigqwke21pblByaWNlfWAsXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBhdmFpbGFibGU6IGZhbHNlLFxyXG4gICAgICBzdGF0dXM6ICdhYm92ZV90YXJnZXQnLFxyXG4gICAgICBwcmljZTogbWluUHJpY2UsXHJcbiAgICAgIGRldGFpbHM6IGBDaGVhcGVzdCB0aWNrZXQg4oKsJHttaW5QcmljZX0gKHlvdXIgdGFyZ2V0OiDigqwke21heFByaWNlfSlgLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBhdmFpbGFibGU6IHRydWUsXHJcbiAgICBzdGF0dXM6ICdvbnNhbGUnLFxyXG4gICAgcHJpY2U6IG1pblByaWNlLFxyXG4gICAgcHJpY2VNYXg6IG1heEF2YWlsYWJsZSxcclxuICAgIGRldGFpbHM6IGBUaWNrZXRzIGF2YWlsYWJsZSBmcm9tIOKCrCR7bWluUHJpY2V9YCxcclxuICB9O1xyXG59XHJcbiJdLCJuYW1lcyI6WyJUTV9BUElfS0VZIiwicHJvY2VzcyIsImVudiIsIlRJQ0tFVE1BU1RFUl9BUElfS0VZIiwiVE1fQkFTRV9VUkwiLCJUTV9DT1VOVFJZX0NPREUiLCJUTV9USU1FT1VUIiwiREVNT19NT0RFIiwiTU9DS19FVkVOVFMiLCJpZCIsIm5hbWUiLCJkYXRlcyIsInN0YXJ0IiwibG9jYWxEYXRlIiwibG9jYWxUaW1lIiwic3RhdHVzIiwiY29kZSIsIl9lbWJlZGRlZCIsInZlbnVlcyIsImNpdHkiLCJwcmljZVJhbmdlcyIsIm1pbiIsIm1heCIsInVybCIsInNlYXJjaEV2ZW50cyIsInF1ZXJ5Iiwic2l6ZSIsInEiLCJ0b0xvd2VyQ2FzZSIsInJlc3VsdHMiLCJmaWx0ZXIiLCJlIiwiaW5jbHVkZXMiLCJsZW5ndGgiLCJzbGljZSIsInBhcmFtcyIsIlVSTFNlYXJjaFBhcmFtcyIsImFwaWtleSIsImtleXdvcmQiLCJjb3VudHJ5Q29kZSIsIlN0cmluZyIsInNvcnQiLCJyZXNwIiwiZmV0Y2giLCJzaWduYWwiLCJBYm9ydFNpZ25hbCIsInRpbWVvdXQiLCJvayIsImRhdGEiLCJqc29uIiwiZXZlbnRzIiwiZ2V0RXZlbnQiLCJldmVudElkIiwiZmluZCIsImZvcm1hdEV2ZW50IiwiZXZlbnQiLCJ2ZW51ZSIsInByaWNlTWluIiwicHJpY2VNYXgiLCJkYXRlIiwidGltZSIsImNoZWNrQXZhaWxhYmlsaXR5IiwibWF4UHJpY2UiLCJxdWFudGl0eSIsImF2YWlsYWJsZSIsImRldGFpbHMiLCJldmVudFN0YXR1cyIsIm1pblByaWNlIiwibWF4QXZhaWxhYmxlIiwicHJpY2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/ticketmaster.ts\n");

/***/ }),

/***/ "(rsc)/./lib/twilio.ts":
/*!***********************!*\
  !*** ./lib/twilio.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   generateTwimlResponse: () => (/* binding */ generateTwimlResponse),\n/* harmony export */   sendWhatsApp: () => (/* binding */ sendWhatsApp),\n/* harmony export */   validateTwilioSignature: () => (/* binding */ validateTwilioSignature)\n/* harmony export */ });\n/* harmony import */ var twilio__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! twilio */ \"(rsc)/./node_modules/twilio/lib/index.js\");\n/* harmony import */ var twilio__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(twilio__WEBPACK_IMPORTED_MODULE_0__);\n\nconst accountSid = process.env.TWILIO_ACCOUNT_SID || \"\";\nconst authToken = process.env.TWILIO_AUTH_TOKEN || \"\";\nconst whatsappNumber = process.env.TWILIO_WHATSAPP_NUMBER || \"whatsapp:+14155238886\";\nlet client = null;\nfunction getClient() {\n    if (!client) {\n        if (!accountSid || !authToken) {\n            throw new Error(\"TWILIO_ACCOUNT_SID and TWILIO_AUTH_TOKEN must be set\");\n        }\n        client = twilio__WEBPACK_IMPORTED_MODULE_0___default()(accountSid, authToken);\n    }\n    return client;\n}\nasync function sendWhatsApp(to, message) {\n    try {\n        const twilioClient = getClient();\n        const result = await twilioClient.messages.create({\n            from: whatsappNumber,\n            to: to.startsWith(\"whatsapp:\") ? to : `whatsapp:${to}`,\n            body: message\n        });\n        return {\n            success: true,\n            sid: result.sid\n        };\n    } catch (error) {\n        console.error(\"Twilio send error:\", error.message);\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n}\nfunction validateTwilioSignature(url, params, signature) {\n    if (!authToken) return false;\n    return twilio__WEBPACK_IMPORTED_MODULE_0___default().validateRequest(authToken, signature, url, params);\n}\nfunction generateTwimlResponse(message) {\n    const twiml = new (twilio__WEBPACK_IMPORTED_MODULE_0___default().twiml).MessagingResponse();\n    twiml.message(message);\n    return twiml.toString();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvdHdpbGlvLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQTRCO0FBRTVCLE1BQU1DLGFBQWFDLFFBQVFDLEdBQUcsQ0FBQ0Msa0JBQWtCLElBQUk7QUFDckQsTUFBTUMsWUFBWUgsUUFBUUMsR0FBRyxDQUFDRyxpQkFBaUIsSUFBSTtBQUNuRCxNQUFNQyxpQkFBaUJMLFFBQVFDLEdBQUcsQ0FBQ0ssc0JBQXNCLElBQUk7QUFFN0QsSUFBSUMsU0FBK0I7QUFFbkMsU0FBU0M7SUFDUCxJQUFJLENBQUNELFFBQVE7UUFDWCxJQUFJLENBQUNSLGNBQWMsQ0FBQ0ksV0FBVztZQUM3QixNQUFNLElBQUlNLE1BQU07UUFDbEI7UUFDQUYsU0FBU1QsNkNBQU1BLENBQUNDLFlBQVlJO0lBQzlCO0lBQ0EsT0FBT0k7QUFDVDtBQUVPLGVBQWVHLGFBQWFDLEVBQVUsRUFBRUMsT0FBZTtJQUM1RCxJQUFJO1FBQ0YsTUFBTUMsZUFBZUw7UUFDckIsTUFBTU0sU0FBUyxNQUFNRCxhQUFhRSxRQUFRLENBQUNDLE1BQU0sQ0FBQztZQUNoREMsTUFBTVo7WUFDTk0sSUFBSUEsR0FBR08sVUFBVSxDQUFDLGVBQWVQLEtBQUssQ0FBQyxTQUFTLEVBQUVBLEdBQUcsQ0FBQztZQUN0RFEsTUFBTVA7UUFDUjtRQUNBLE9BQU87WUFBRVEsU0FBUztZQUFNQyxLQUFLUCxPQUFPTyxHQUFHO1FBQUM7SUFDMUMsRUFBRSxPQUFPQyxPQUFZO1FBQ25CQyxRQUFRRCxLQUFLLENBQUMsc0JBQXNCQSxNQUFNVixPQUFPO1FBQ2pELE9BQU87WUFBRVEsU0FBUztZQUFPRSxPQUFPQSxNQUFNVixPQUFPO1FBQUM7SUFDaEQ7QUFDRjtBQUVPLFNBQVNZLHdCQUNkQyxHQUFXLEVBQ1hDLE1BQThCLEVBQzlCQyxTQUFpQjtJQUVqQixJQUFJLENBQUN4QixXQUFXLE9BQU87SUFDdkIsT0FBT0wsNkRBQXNCLENBQUNLLFdBQVd3QixXQUFXRixLQUFLQztBQUMzRDtBQUVPLFNBQVNHLHNCQUFzQmpCLE9BQWU7SUFDbkQsTUFBTWtCLFFBQVEsSUFBSWhDLHFEQUFZLENBQUNpQyxpQkFBaUI7SUFDaERELE1BQU1sQixPQUFPLENBQUNBO0lBQ2QsT0FBT2tCLE1BQU1FLFFBQVE7QUFDdkIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aWNrZXR3YXRjaC1sYW5kaW5nLy4vbGliL3R3aWxpby50cz84NmU1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0d2lsaW8gZnJvbSAndHdpbGlvJztcclxuXHJcbmNvbnN0IGFjY291bnRTaWQgPSBwcm9jZXNzLmVudi5UV0lMSU9fQUNDT1VOVF9TSUQgfHwgJyc7XHJcbmNvbnN0IGF1dGhUb2tlbiA9IHByb2Nlc3MuZW52LlRXSUxJT19BVVRIX1RPS0VOIHx8ICcnO1xyXG5jb25zdCB3aGF0c2FwcE51bWJlciA9IHByb2Nlc3MuZW52LlRXSUxJT19XSEFUU0FQUF9OVU1CRVIgfHwgJ3doYXRzYXBwOisxNDE1NTIzODg4Nic7XHJcblxyXG5sZXQgY2xpZW50OiB0d2lsaW8uVHdpbGlvIHwgbnVsbCA9IG51bGw7XHJcblxyXG5mdW5jdGlvbiBnZXRDbGllbnQoKTogdHdpbGlvLlR3aWxpbyB7XHJcbiAgaWYgKCFjbGllbnQpIHtcclxuICAgIGlmICghYWNjb3VudFNpZCB8fCAhYXV0aFRva2VuKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignVFdJTElPX0FDQ09VTlRfU0lEIGFuZCBUV0lMSU9fQVVUSF9UT0tFTiBtdXN0IGJlIHNldCcpO1xyXG4gICAgfVxyXG4gICAgY2xpZW50ID0gdHdpbGlvKGFjY291bnRTaWQsIGF1dGhUb2tlbik7XHJcbiAgfVxyXG4gIHJldHVybiBjbGllbnQ7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZW5kV2hhdHNBcHAodG86IHN0cmluZywgbWVzc2FnZTogc3RyaW5nKTogUHJvbWlzZTx7IHN1Y2Nlc3M6IGJvb2xlYW47IHNpZD86IHN0cmluZzsgZXJyb3I/OiBzdHJpbmcgfT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB0d2lsaW9DbGllbnQgPSBnZXRDbGllbnQoKTtcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHR3aWxpb0NsaWVudC5tZXNzYWdlcy5jcmVhdGUoe1xyXG4gICAgICBmcm9tOiB3aGF0c2FwcE51bWJlcixcclxuICAgICAgdG86IHRvLnN0YXJ0c1dpdGgoJ3doYXRzYXBwOicpID8gdG8gOiBgd2hhdHNhcHA6JHt0b31gLFxyXG4gICAgICBib2R5OiBtZXNzYWdlLFxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBzaWQ6IHJlc3VsdC5zaWQgfTtcclxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdUd2lsaW8gc2VuZCBlcnJvcjonLCBlcnJvci5tZXNzYWdlKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlVHdpbGlvU2lnbmF0dXJlKFxyXG4gIHVybDogc3RyaW5nLFxyXG4gIHBhcmFtczogUmVjb3JkPHN0cmluZywgc3RyaW5nPixcclxuICBzaWduYXR1cmU6IHN0cmluZ1xyXG4pOiBib29sZWFuIHtcclxuICBpZiAoIWF1dGhUb2tlbikgcmV0dXJuIGZhbHNlO1xyXG4gIHJldHVybiB0d2lsaW8udmFsaWRhdGVSZXF1ZXN0KGF1dGhUb2tlbiwgc2lnbmF0dXJlLCB1cmwsIHBhcmFtcyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVR3aW1sUmVzcG9uc2UobWVzc2FnZTogc3RyaW5nKTogc3RyaW5nIHtcclxuICBjb25zdCB0d2ltbCA9IG5ldyB0d2lsaW8udHdpbWwuTWVzc2FnaW5nUmVzcG9uc2UoKTtcclxuICB0d2ltbC5tZXNzYWdlKG1lc3NhZ2UpO1xyXG4gIHJldHVybiB0d2ltbC50b1N0cmluZygpO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJ0d2lsaW8iLCJhY2NvdW50U2lkIiwicHJvY2VzcyIsImVudiIsIlRXSUxJT19BQ0NPVU5UX1NJRCIsImF1dGhUb2tlbiIsIlRXSUxJT19BVVRIX1RPS0VOIiwid2hhdHNhcHBOdW1iZXIiLCJUV0lMSU9fV0hBVFNBUFBfTlVNQkVSIiwiY2xpZW50IiwiZ2V0Q2xpZW50IiwiRXJyb3IiLCJzZW5kV2hhdHNBcHAiLCJ0byIsIm1lc3NhZ2UiLCJ0d2lsaW9DbGllbnQiLCJyZXN1bHQiLCJtZXNzYWdlcyIsImNyZWF0ZSIsImZyb20iLCJzdGFydHNXaXRoIiwiYm9keSIsInN1Y2Nlc3MiLCJzaWQiLCJlcnJvciIsImNvbnNvbGUiLCJ2YWxpZGF0ZVR3aWxpb1NpZ25hdHVyZSIsInVybCIsInBhcmFtcyIsInNpZ25hdHVyZSIsInZhbGlkYXRlUmVxdWVzdCIsImdlbmVyYXRlVHdpbWxSZXNwb25zZSIsInR3aW1sIiwiTWVzc2FnaW5nUmVzcG9uc2UiLCJ0b1N0cmluZyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/twilio.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/twilio","vendor-chunks/semver","vendor-chunks/xmlbuilder","vendor-chunks/jsonwebtoken","vendor-chunks/asynckit","vendor-chunks/math-intrinsics","vendor-chunks/es-errors","vendor-chunks/qs","vendor-chunks/jws","vendor-chunks/call-bind-apply-helpers","vendor-chunks/debug","vendor-chunks/https-proxy-agent","vendor-chunks/get-proto","vendor-chunks/scmp","vendor-chunks/object-inspect","vendor-chunks/mime-db","vendor-chunks/has-symbols","vendor-chunks/gopd","vendor-chunks/function-bind","vendor-chunks/form-data","vendor-chunks/follow-redirects","vendor-chunks/ecdsa-sig-formatter","vendor-chunks/dayjs","vendor-chunks/agent-base","vendor-chunks/axios","vendor-chunks/supports-color","vendor-chunks/side-channel","vendor-chunks/side-channel-weakmap","vendor-chunks/side-channel-map","vendor-chunks/side-channel-list","vendor-chunks/safe-buffer","vendor-chunks/proxy-from-env","vendor-chunks/ms","vendor-chunks/mime-types","vendor-chunks/lodash.once","vendor-chunks/lodash.isstring","vendor-chunks/lodash.isplainobject","vendor-chunks/lodash.isnumber","vendor-chunks/lodash.isinteger","vendor-chunks/lodash.isboolean","vendor-chunks/lodash.includes","vendor-chunks/jwa","vendor-chunks/hasown","vendor-chunks/has-tostringtag","vendor-chunks/has-flag","vendor-chunks/get-intrinsic","vendor-chunks/es-set-tostringtag","vendor-chunks/es-object-atoms","vendor-chunks/es-define-property","vendor-chunks/dunder-proto","vendor-chunks/delayed-stream","vendor-chunks/combined-stream","vendor-chunks/call-bound","vendor-chunks/buffer-equal-constant-time"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwebhook%2Ftwilio%2Froute&page=%2Fapi%2Fwebhook%2Ftwilio%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwebhook%2Ftwilio%2Froute.ts&appDir=C%3A%5CUsers%5Cdylan%5COneDrive%5CDesktop%5Cdylan-portfolio%5Cticketwatch%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cdylan%5COneDrive%5CDesktop%5Cdylan-portfolio%5Cticketwatch&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();